
var sys_data = {"ntdll.dll": {"sub_9EF70": {"args": [], "addr": 651120}, "ZwWorkerFactoryWorkerReady": {"args": [], "addr": 652160}, "ZwWaitForSingleObject": {"args": ["_In_ HANDLE Handle", "_In_ BOOLEAN Alertable", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 652256}, "ZwWriteFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ PFILE_SEGMENT_ELEMENT SegmentArray", "_In_ ULONG Length", "_In_opt_ PLARGE_INTEGER ByteOffset", "_In_opt_ PULONG Key"], "addr": 652384}, "ZwQueryObject": {"args": ["_In_opt_ HANDLE Handle", "_In_ OBJECT_INFORMATION_CLASS ObjectInformationClass", "_Out_writes_bytes_opt_(ObjectInformationLength) PVOID ObjectInformation", "_In_ ULONG ObjectInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 652640}, "ZwFindAtom": {"args": ["_In_reads_bytes_opt_(Length) PWSTR AtomName", "_In_ ULONG Length", "_Out_opt_ PRTL_ATOM Atom"], "addr": 652768}, "ZwQueryValueKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ PUNICODE_STRING ValueName", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_VALUE_INFORMATION_CLASS KeyValueInformationClass", "_Out_writes_bytes_opt_(Length) PVOID KeyValueInformation", "_In_ ULONG Length", "_Deref_out_range_(<=,Length) PULONG ResultLength"], "addr": 652864}, "ZwSetInformationProcess": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PROCESSINFOCLASS ProcessInformationClass", "_In_reads_bytes_opt_(ProcessInformationLength) PVOID ProcessInformation", "_In_ ULONG ProcessInformationLength"], "addr": 653024}, "ZwOpenProcess": {"args": ["_Out_ PHANDLE ProcessHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PCLIENT_ID ClientId"], "addr": 653344}, "ZwMapViewOfSection": {"args": ["_In_ HANDLE SectionHandle", "_In_ HANDLE ProcessHandle", "_Inout_ _At_ (*BaseAddress,_Readable_bytes_ (*ViewSize) _Writable_bytes_ (*ViewSize) _Post_readable_byte_size_ (*ViewSize)) PVOID *BaseAddress", "_In_ ULONG_PTR ZeroBits", "_In_ SIZE_T CommitSize", "_Inout_opt_ PLARGE_INTEGER SectionOffset", "_Inout_ PSIZE_T ViewSize", "_In_ SECTION_INHERIT InheritDisposition", "_In_ ULONG AllocationType", "_In_ ULONG Win32Protect"], "addr": 653408}, "ZwReplyWaitReceivePortEx": {"args": ["_In_ HANDLE PortHandle", "_Out_opt_ PVOID *PortContext", "_In_reads_bytes_opt_(ReplyMessage->u1.s1.TotalLength) PPORT_MESSAGE ReplyMessage", "_Out_ PPORT_MESSAGE ReceiveMessage", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 653504}, "ZwOpenSection": {"args": ["_Out_ PHANDLE SectionHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 653888}, "ZwQueryTimer": {"args": ["_In_ HANDLE TimerHandle", "_In_ TIMER_INFORMATION_CLASS TimerInformationClass", "_Out_writes_bytes_(TimerInformationLength) PVOID TimerInformation", "_In_ ULONG TimerInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 653920}, "ZwFsControlFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ ULONG FsControlCode", "_In_reads_bytes_opt_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(OutputBufferLength) PVOID OutputBuffer", "_In_ ULONG OutputBufferLength"], "addr": 653952}, "ZwClearEvent": {"args": ["_In_ HANDLE EventHandle"], "addr": 654112}, "ZwOpenEvent": {"args": ["_Out_ PHANDLE EventHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 654176}, "ZwContinue": {"args": ["_In_ PCONTEXT ContextRecord", "_In_ BOOLEAN TestAlert"], "addr": 654272}, "ZwCreateEvent": {"args": ["_Out_ PHANDLE EventHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ EVENT_TYPE EventType", "_In_ BOOLEAN InitialState"], "addr": 654432}, "ZwResumeThread": {"args": ["_In_ HANDLE ThreadHandle", "_Out_opt_ PULONG PreviousSuspendCount"], "addr": 654752}, "ZwAccessCheckByTypeAndAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ ACCESS_MASK DesiredAccess", "_In_ AUDIT_EVENT_TYPE AuditType", "_In_ ULONG Flags", "_In_reads_opt_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_ PACCESS_MASK GrantedAccess", "_Out_ PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 654976}, "ZwCancelIoFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock"], "addr": 655088}, "ZwTraceEvent": {"args": ["_In_opt_ HANDLE TraceHandle", "_In_ ULONG Flags", "_In_ ULONG FieldSize", "_In_ PVOID Fields"], "addr": 655120}, "ZwSetValueKey": {"args": ["_In_ HANDLE KeyHandle", "_In_opt_ PUNICODE_STRING ValueName", "_In_opt_ ULONG TitleIndex", "_In_ ULONG Type", "_In_reads_bytes_opt_(DataSize) PVOID Data", "_In_ ULONG DataSize"], "addr": 655184}, "ZwSetTimer": {"args": ["_In_ HANDLE TimerHandle", "_In_ PLARGE_INTEGER DueTime", "_In_opt_ PTIMER_APC_ROUTINE TimerApcRoutine", "_In_opt_ PVOID TimerContext", "_In_ BOOLEAN ResumeTimer", "_In_opt_ LONG Period", "_Out_opt_ PBOOLEAN PreviousState"], "addr": 655248}, "ZwAccessCheckByTypeResultListAndAuditAlarmByHandle": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ HANDLE ClientToken", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ ACCESS_MASK DesiredAccess", "_In_ AUDIT_EVENT_TYPE AuditType", "_In_ ULONG Flags", "_In_reads_opt_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_writes_(ObjectTypeListLength) PACCESS_MASK GrantedAccess", "_Out_writes_(ObjectTypeListLength) PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 655376}, "ZwAddAtomEx": {"args": [], "addr": 655472}, "ZwAddBootEntry": {"args": ["_In_ PBOOT_ENTRY BootEntry", "_Out_opt_ PULONG Id"], "addr": 655504}, "ZwAlpcDeletePortSection": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_In_ ALPC_HANDLE SectionHandle"], "addr": 656208}, "ZwCancelTimer2": {"args": ["_In_ HANDLE TimerHandle", "_In_ PT2_CANCEL_PARAMETERS Parameters"], "addr": 656848}, "ZwChangeThreadState": {"args": [], "addr": 656944}, "ZwCommitTransaction": {"args": ["_In_ HANDLE TransactionHandle", "_In_ BOOLEAN Wait"], "addr": 657072}, "ZwCreateDirectoryObject": {"args": ["_Out_ PHANDLE DirectoryHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 657552}, "ZwCreateEnclave": {"args": [], "addr": 657616}, "ZwCreateSemaphore": {"args": ["_Out_ PHANDLE SemaphoreHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ LONG InitialCount", "_In_ LONG MaximumCount"], "addr": 658416}, "ZwCreateTransactionManager": {"args": ["_Out_ PHANDLE TmHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PUNICODE_STRING LogFileName", "_In_opt_ ULONG CreateOptions", "_In_opt_ ULONG CommitStrength"], "addr": 658704}, "ZwCreateWnfStateName": {"args": ["_Out_ PWNF_STATE_NAME StateName", "_In_ WNF_STATE_NAME_LIFETIME NameLifetime", "_In_ WNF_DATA_SCOPE DataScope", "_In_ BOOLEAN PersistData", "_In_opt_ PCWNF_TYPE_ID TypeId", "_In_ ULONG MaximumStateSize", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor"], "addr": 658832}, "ZwCreateWorkerFactory": {"args": [], "addr": 658864}, "ZwDeleteAtom": {"args": ["_In_ RTL_ATOM Atom"], "addr": 658960}, "ZwDeleteDriverEntry": {"args": ["_In_ ULONG Id"], "addr": 659024}, "ZwDeleteObjectAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ BOOLEAN GenerateOnClose"], "addr": 659120}, "ZwDeletePrivateNamespace": {"args": ["_In_ HANDLE NamespaceHandle"], "addr": 659152}, "ZwDeleteValueKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ PUNICODE_STRING ValueName"], "addr": 659184}, "ZwDeleteWnfStateData": {"args": ["_In_ PCWNF_STATE_NAME StateName", "_In_opt_ const PVOID ExplicitScope"], "addr": 659216}, "ZwDisplayString": {"args": ["_In_ PUNICODE_STRING String"], "addr": 659344}, "ZwFilterBootOption": {"args": ["_In_ FILTER_BOOT_OPTION_OPERATION FilterOperation", "_In_ ULONG ObjectType", "_In_ ULONG ElementType", "_In_reads_bytes_opt_(DataSize) PVOID Data", "_In_ ULONG DataSize"], "addr": 659600}, "ZwFlushInstructionCache": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ PVOID BaseAddress", "_In_ SIZE_T Length"], "addr": 659760}, "ZwFlushProcessWriteBuffers": {"args": ["VOID"], "addr": 659824}, "ZwGetCurrentProcessorNumberEx": {"args": ["_Out_ PPROCESSOR_NUMBER ProcNumber"], "addr": 660144}, "ZwGetNextProcess": {"args": ["_In_opt_ HANDLE ProcessHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ ULONG HandleAttributes", "_In_ ULONG Flags", "_Out_ PHANDLE NewProcessHandle"], "addr": 660240}, "ZwGetNextThread": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ HANDLE ThreadHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ ULONG HandleAttributes", "_In_ ULONG Flags", "_Out_ PHANDLE NewThreadHandle"], "addr": 660272}, "ZwInitializeRegistry": {"args": ["_In_ USHORT BootCondition"], "addr": 660528}, "ZwLoadKey2": {"args": ["_In_ POBJECT_ATTRIBUTES  TargetKey", "_In_ POBJECT_ATTRIBUTES  SourceFile", "_In_ ULONG        Flags"], "addr": 660784}, "ZwManageHotPatch": {"args": [], "addr": 661072}, "ZwManagePartition": {"args": ["_In_ HANDLE TargetHandle", "_In_opt_ HANDLE SourceHandle", "_In_ MEMORY_PARTITION_INFORMATION_CLASS PartitionInformationClass", "_In_ PVOID PartitionInformation", "_In_ ULONG PartitionInformationLength"], "addr": 661104}, "ZwMapUserPhysicalPages": {"args": ["_In_ PVOID VirtualAddress", "_In_ ULONG_PTR NumberOfPages", "_In_reads_opt_(NumberOfPages) PULONG_PTR UserPfnArray"], "addr": 661168}, "ZwMapViewOfSectionEx": {"args": [], "addr": 661200}, "ZwNotifyChangeKey": {"args": ["_In_ HANDLE KeyHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ ULONG CompletionFilter", "_In_ BOOLEAN WatchTree", "_Out_writes_bytes_opt_(BufferSize) PVOID Buffer", "_In_ ULONG BufferSize", "_In_ BOOLEAN Asynchronous"], "addr": 661360}, "ZwNotifyChangeMultipleKeys": {"args": ["_In_ HANDLE MasterKeyHandle", "_In_opt_ ULONG Count", "_In_reads_opt_(Count) OBJECT_ATTRIBUTES SubordinateObjects[]", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ ULONG CompletionFilter", "_In_ BOOLEAN WatchTree", "_Out_writes_bytes_opt_(BufferSize) PVOID Buffer", "_In_ ULONG BufferSize", "_In_ BOOLEAN Asynchronous"], "addr": 661392}, "ZwOpenEnlistment": {"args": ["_Out_ PHANDLE EnlistmentHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ HANDLE ResourceManagerHandle", "_In_ LPGUID EnlistmentGuid", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661488}, "ZwOpenPartition": {"args": ["_Out_ PHANDLE PartitionHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661808}, "ZwOpenSymbolicLinkObject": {"args": ["_Out_ PHANDLE LinkHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 662032}, "ZwOpenThread": {"args": ["_Out_ PHANDLE ThreadHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PCLIENT_ID ClientId"], "addr": 662064}, "ZwOpenTransaction": {"args": ["_Out_ PHANDLE TmHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PUNICODE_STRING LogFileName", "_In_opt_ LPGUID TmIdentity", "_In_opt_ ULONG OpenOptions"], "addr": 662128}, "ZwPropagationFailed": {"args": ["_In_ HANDLE ResourceManagerHandle", "_In_ ULONG RequestCookie", "_In_ NTSTATUS PropStatus"], "addr": 662480}, "ZwPssCaptureVaSpaceBulk": {"args": [], "addr": 662512}, "ZwQueryDirectoryObject": {"args": ["_In_ HANDLE DirectoryHandle", "_Out_writes_bytes_opt_(Length) PVOID Buffer", "_In_ ULONG Length", "_In_ BOOLEAN ReturnSingleEntry", "_In_ BOOLEAN RestartScan", "_Inout_ PULONG Context", "_Out_opt_ PULONG ReturnLength"], "addr": 662736}, "ZwQueryInformationEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_ ENLISTMENT_INFORMATION_CLASS EnlistmentInformationClass", "_Out_writes_bytes_(EnlistmentInformationLength) PVOID EnlistmentInformation", "_In_ ULONG EnlistmentInformationLength", "_Out_ PULONG ReturnLength"], "addr": 662960}, "ZwQueryInformationJobObject": {"args": ["_In_opt_ HANDLE JobHandle", "_In_ JOBOBJECTINFOCLASS JobObjectInformationClass", "_Out_writes_bytes_(JobObjectInformationLength) PVOID JobObjectInformation", "_In_ ULONG JobObjectInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 662992}, "ZwQueryInformationPort": {"args": ["_In_opt_ HANDLE PortHandle", "_In_ __drv_strictTypeMatch(__drv_typeConst) PORT_INFORMATION_CLASS PortInformationClass", "_Out_writes_bytes_to_(Length,*ReturnLength) PVOID PortInformation", "_In_ ULONG Length", "_Out_opt_ PULONG ReturnLength"], "addr": 663024}, "ZwQueryInformationResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle", "_In_ RESOURCEMANAGER_INFORMATION_CLASS ResourceManagerInformationClass", "_Out_writes_bytes_(ResourceManagerInformationLength) PVOID ResourceManagerInformation", "_In_ ULONG ResourceManagerInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 663056}, "ZwQueryInformationTransactionManager": {"args": ["_In_ HANDLE TransactionManagerHandle", "_In_ TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass", "_Out_writes_bytes_(TransactionManagerInformationLength) PVOID TransactionManagerInformation", "_In_ ULONG TransactionManagerInformationLength", "_Out_ PULONG ReturnLength"], "addr": 663120}, "ZwQueryIntervalProfile": {"args": ["_In_ KPROFILE_SOURCE ProfileSource", "_Out_ PULONG Interval"], "addr": 663216}, "ZwQueryQuotaInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID Buffer", "_In_ ULONG Length", "_In_ BOOLEAN ReturnSingleEntry", "_In_reads_bytes_opt_(SidListLength) PVOID SidList", "_In_ ULONG SidListLength", "_In_reads_bytes_opt_((8 + (4 * ((SID *)StartSid)->SubAuthorityCount))) // SeLengthSid()\n    PSID StartSid", "_In_ BOOLEAN RestartScan"], "addr": 663504}, "ZwQuerySystemEnvironmentValue": {"args": ["_In_ PUNICODE_STRING VariableName", "_Out_writes_bytes_(ValueLength) PWSTR VariableValue", "_In_ USHORT ValueLength", "_Out_opt_ PUSHORT ReturnLength"], "addr": 663696}, "ZwQueryWnfStateNameInformation": {"args": ["_In_ PCWNF_STATE_NAME StateName", "_In_ WNF_STATE_NAME_INFORMATION NameInfoClass", "_In_opt_ const PVOID ExplicitScope", "_Out_writes_bytes_(InfoBufferSize) PVOID InfoBuffer", "_In_ ULONG InfoBufferSize"], "addr": 663856}, "ZwQueueApcThreadEx2": {"args": [], "addr": 663920}, "ZwRecoverTransactionManager": {"args": ["_In_ HANDLE TransactionManagerHandle"], "addr": 664144}, "ZwResetWriteWatch": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PVOID BaseAddress", "_In_ SIZE_T RegionSize"], "addr": 664592}, "ZwRollbackEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 664752}, "ZwRollbackRegistryTransaction": {"args": [], "addr": 664784}, "ZwSecureConnectPort": {"args": ["_Out_ PHANDLE PortHandle", "_In_ PUNICODE_STRING PortName", "_In_ PSECURITY_QUALITY_OF_SERVICE SecurityQos", "_Inout_opt_ PPORT_VIEW ClientView", "_In_opt_ PSID RequiredServerSid", "_Inout_opt_ PREMOTE_PORT_VIEW ServerView", "_Out_opt_ PULONG MaxMessageLength", "_Inout_updates_bytes_to_opt_(*ConnectionInformationLength,*ConnectionInformationLength) PVOID ConnectionInformation", "_Inout_opt_ PULONG ConnectionInformationLength"], "addr": 664976}, "ZwSetContextThread": {"args": ["_In_ HANDLE ThreadHandle", "_In_ PCONTEXT ThreadContext"], "addr": 665168}, "ZwSetDefaultUILanguage": {"args": ["_In_ LANGID DefaultUILanguageId"], "addr": 665296}, "ZwSetHighWaitLowEventPair": {"args": ["_In_ HANDLE EventPairHandle"], "addr": 665424}, "ZwSetInformationKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_SET_INFORMATION_CLASS KeySetInformationClass", "_In_reads_bytes_(KeySetInformationLength) PVOID KeySetInformation", "_In_ ULONG KeySetInformationLength"], "addr": 665648}, "ZwSetInformationResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle", "_In_ RESOURCEMANAGER_INFORMATION_CLASS ResourceManagerInformationClass", "_In_reads_bytes_(ResourceManagerInformationLength) PVOID ResourceManagerInformation", "_In_ ULONG ResourceManagerInformationLength"], "addr": 665680}, "ZwSetIntervalProfile": {"args": ["_In_ ULONG Interval", "_In_ KPROFILE_SOURCE Source"], "addr": 665904}, "ZwSetSecurityObject": {"args": ["_In_ HANDLE Handle", "_In_ SECURITY_INFORMATION SecurityInformation", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor"], "addr": 666128}, "ZwSetUuidSeed": {"args": ["_In_reads_bytes_(6) PCHAR Seed"], "addr": 666448}, "ZwSetWnfProcessNotificationEvent": {"args": ["_In_ HANDLE NotificationEvent"], "addr": 666512}, "ZwTestAlert": {"args": ["VOID"], "addr": 666960}, "ZwThawRegistry": {"args": [], "addr": 666992}, "ZwThawTransactions": {"args": ["void"], "addr": 667024}, "ZwUnloadDriver": {"args": ["_In_ PUNICODE_STRING DriverServiceName"], "addr": 667152}, "ZwUnlockVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_Inout_ PVOID *BaseAddress", "_Inout_ PSIZE_T RegionSize", "_In_ ULONG MapType"], "addr": 667312}, "ZwWaitForAlertByThreadId": {"args": [], "addr": 667472}}, "win32u.dll": {"NtUserGetMessage": {"args": [], "addr": 5408}, "NtUserRedrawWindow": {"args": [], "addr": 5824}, "NtGdiRectVisible": {"args": ["_In_ HDC hdc", "_In_ LPRECT prc"], "addr": 6752}, "NtGdiCombineRgn": {"args": ["_In_ HRGN hrgnDst", "_In_ HRGN hrgnSrc1", "_In_ HRGN hrgnSrc2", "_In_ int iMode"], "addr": 6784}, "NtGdiGetDCObject": {"args": ["_In_ HDC hdc", "_In_ int itype"], "addr": 6816}, "NtUserDispatchMessage": {"args": [], "addr": 6848}, "NtGdiCreateCompatibleBitmap": {"args": ["_In_ HDC hdc", "_In_ int cx", "_In_ int cy"], "addr": 7520}, "NtUserSBGetParms": {"args": [], "addr": 7616}, "NtUserSetParent": {"args": [], "addr": 8864}, "NtUserFillWindow": {"args": [], "addr": 9408}, "NtGdiSetLayout": {"args": ["_In_ HDC hdc", "_In_ LONG wox", "_In_ DWORD dwLayout"], "addr": 9824}, "NtGdiExcludeClipRect": {"args": ["_In_ HDC hdc", "_In_ int xLeft", "_In_ int yTop", "_In_ int xRight", "_In_ int yBottom"], "addr": 9920}, "NtUserGetAtomName": {"args": [], "addr": 10272}, "NtUserScrollWindowEx": {"args": [], "addr": 10912}, "NtUserSetThreadState": {"args": [], "addr": 11616}, "NtUserTrackMouseEvent": {"args": [], "addr": 11680}, "NtUserSetInformationThread": {"args": [], "addr": 11872}, "NtUserGetClipboardFormatName": {"args": [], "addr": 12128}, "NtUserCreateAcceleratorTable": {"args": [], "addr": 12384}, "NtGdiGetBitmapDimension": {"args": ["_In_ HBITMAP hbm", "_Out_ LPSIZE psize"], "addr": 12736}, "NtUserCheckMenuItem": {"args": [], "addr": 12960}, "NtGdiGetSystemPaletteUse": {"args": ["_In_ HDC hdc"], "addr": 13408}, "NtDCompositionCommitChannel": {"args": [], "addr": 14208}, "NtDCompositionCreateConnection": {"args": [], "addr": 14400}, "NtDCompositionDestroyConnection": {"args": [], "addr": 14560}, "NtDCompositionGetFrameStatistics": {"args": [], "addr": 14912}, "NtDCompositionWaitForChannel": {"args": [], "addr": 15648}, "NtDxgkEnumAdapters3": {"args": [], "addr": 16128}, "NtDxgkGetAvailableTrackedWorkloadIndex": {"args": [], "addr": 16192}, "NtFlipObjectConsumerPostMessage": {"args": [], "addr": 16992}, "NtGdiBRUSHOBJ_ulGetBrushColor": {"args": ["_In_ BRUSHOBJ *pbo"], "addr": 17920}, "NtGdiDDCCISaveCurrentSettings": {"args": [], "addr": 18816}, "NtGdiDDCCISetVCPFeature": {"args": [], "addr": 18848}, "NtGdiDdDDICheckSharedResourceAccess": {"args": [], "addr": 19360}, "NtGdiDdDDICreateHwContext": {"args": [], "addr": 19680}, "NtGdiDdDDICreateOverlay": {"args": [], "addr": 19840}, "NtGdiDdDDICreateSynchronizationObject": {"args": [], "addr": 19968}, "NtGdiDdDDIDestroyProtectedSession": {"args": [], "addr": 20384}, "NtGdiDdDDIEnumAdapters": {"args": [], "addr": 20544}, "NtGdiDdDDIGetContextSchedulingPriority": {"args": [], "addr": 20896}, "NtGdiDdDDIInvalidateCache": {"args": [], "addr": 21664}, "NtGdiDdDDIMapGpuVirtualAddress": {"args": [], "addr": 21792}, "NtGdiDdDDINetDispQueryMiracastDisplayDeviceSupport": {"args": [], "addr": 21920}, "NtGdiDdDDIPresentRedirected": {"args": [], "addr": 22880}, "NtGdiDdDDISignalSynchronizationObjectFromCpu": {"args": [], "addr": 24384}, "NtGdiDdDDISubmitWaitForSyncObjectsToHwQueue": {"args": [], "addr": 24576}, "NtGdiDdDDIWaitForVerticalBlankEvent2": {"args": [], "addr": 24992}, "NtGdiDdNotifyFullscreenSpriteUpdate": {"args": ["_In_ HDC hdc", "_In_ HANDLE hSprite"], "addr": 25056}, "NtGdiDeleteColorTransform": {"args": ["_In_ HDC hdc", "_In_ HANDLE hColorTransform"], "addr": 25120}, "NtGdiEngCheckAbort": {"args": ["_In_ SURFOBJ *pso"], "addr": 25600}, "NtGdiFONTOBJ_cGetGlyphs": {"args": ["_In_ FONTOBJ *pfo", "_In_ ULONG iMode", "_In_ ULONG cGlyph", "_In_ HGLYPH *phg", "_At_((GLYPHDATA **)ppvGlyph,_Outptr_) PVOID *ppvGlyph"], "addr": 26656}, "NtGdiFONTOBJ_pvTrueTypeFontFile": {"args": ["_In_ FONTOBJ *pfo", "_Out_ ULONG *pcjFile"], "addr": 26784}, "NtGdiFONTOBJ_vGetInfo": {"args": ["_In_ FONTOBJ *pfo", "_In_ ULONG cjSize", "_Out_writes_bytes_(cjSize) FONTINFO *pfi"], "addr": 26848}, "NtGdiGetDeviceCaps": {"args": ["_In_ HDC hdc", "_In_ int i"], "addr": 27456}, "NtGdiGetEntry": {"args": ["_In_ int index", "_Out_writes_bytes_(ENTRY_SIZE) PVOID pEntry"], "addr": 27680}, "NtGdiGetMonitorID": {"args": ["_In_ HDC hdc", "_In_ DWORD dwSize", "_Out_writes_bytes_(dwSize) LPWSTR pszMonitorID"], "addr": 28064}, "NtGdiGetStringBitmapW": {"args": ["_In_ HDC hdc", "_In_ LPWSTR pwsz", "_In_ UINT cwc", "_In_ UINT cj", "_Out_writes_bytes_(cj) BYTE *lpSB"], "addr": 28544}, "NtGdiGetSuggestedOPMProtectedOutputArraySize": {"args": [], "addr": 28576}, "NtGdiPATHOBJ_vEnumStart": {"args": ["_In_ PATHOBJ *ppo"], "addr": 29280}, "NtGdiResetDC": {"args": [], "addr": 29664}, "NtGdiSetPUMPDOBJ": {"args": ["_In_opt_ HUMPD humpd", "_In_ BOOL bStoreID", "_Inout_opt_ HUMPD *phumpd", "_Out_opt_ BOOL *pbWOW64"], "addr": 30432}, "NtGdiSwapBuffers": {"args": ["_In_ HDC hdc"], "addr": 30784}, "NtKSTWait": {"args": [], "addr": 31392}, "NtModerncoreCreateDCompositionHwndTarget": {"args": [], "addr": 32576}, "NtModerncoreCreateGDIHwndTarget": {"args": [], "addr": 32608}, "NtQueryCompositionInputQueueAndTransform": {"args": [], "addr": 33216}, "NtSetCompositionSurfaceAnalogExclusive": {"args": [], "addr": 34272}, "NtUserAutoPromoteMouseInPointer": {"args": [], "addr": 35072}, "NtUserBuildHimcList": {"args": [], "addr": 35296}, "NtUserClearRunWakeBit": {"args": [], "addr": 35808}, "NtUserClipCursor": {"args": [], "addr": 35904}, "NtUserCreateActivationObject": {"args": [], "addr": 36064}, "NtUserDisableThreadIme": {"args": [], "addr": 36960}, "NtUserDisplayConfigSetDeviceInfo": {"args": [], "addr": 37056}, "NtUserGetClipboardMetadata": {"args": [], "addr": 38784}, "NtUserGetClipboardViewer": {"args": [], "addr": 38816}, "NtUserGetCursor": {"args": [], "addr": 38944}, "NtUserGetGestureConfig": {"args": [], "addr": 39392}, "NtUserGetIMEShowStatus": {"args": [], "addr": 39584}, "NtUserGetPointerCursorId": {"args": [], "addr": 40384}, "NtUserGetPrecisionTouchPadConfiguration": {"args": [], "addr": 40800}, "NtUserGetRawInputDeviceList": {"args": [], "addr": 41152}, "NtUserGetRequiredCursorSizes": {"args": [], "addr": 41248}, "NtUserGetResizeDCompositionSynchronizationObject": {"args": [], "addr": 41280}, "NtUserGetSharedWindowData": {"args": [], "addr": 41344}, "NtUserInitializePointerDeviceInjection": {"args": [], "addr": 42688}, "NtUserIsMouseInPointerEnabled": {"args": [], "addr": 43136}, "NtUserLW_LoadFonts": {"args": [], "addr": 43424}, "NtUserQueryInformationThread": {"args": [], "addr": 44928}, "NtUserRegisterBSDRWindow": {"args": [], "addr": 45248}, "NtUserRegisterEdgy": {"args": [], "addr": 45312}, "NtUserRegisterServicesProcess": {"args": [], "addr": 45696}, "NtUserReleaseDC": {"args": [], "addr": 46080}, "NtUserRestoreWindowDpiChanges": {"args": [], "addr": 46912}, "NtUserSetCancelRotationDelayHintWindow": {"args": [], "addr": 47328}, "NtUserSetDesktopColorTransform": {"args": [], "addr": 47616}, "NtUserSetMessageExtraInfo": {"args": [], "addr": 48576}, "NtUserSetProgmanWindow": {"args": [], "addr": 49056}, "NtUserShowCursor": {"args": [], "addr": 50144}, "NtUserSignalRedirectionStartComplete": {"args": [], "addr": 50368}, "NtUserUnregisterSessionPort": {"args": [], "addr": 50976}, "NtUserUpdateClientRect": {"args": [], "addr": 51040}, "NtUserUpdateInputContext": {"args": [], "addr": 51104}, "NtUserUpdateInstance": {"args": [], "addr": 51136}, "NtUserUpdateLayeredWindow": {"args": [], "addr": 51168}, "NtUserUserHandleGrantAccess": {"args": [], "addr": 51392}}};
var funcs_map = {};
var register_args = ["rcx", "rdx", "r8", "r9"];

function lib_includes(libname, liblist) {
  for (var i = 0; i < liblist.length; i++) {
    if (libname.toLowerCase() == liblist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function func_includes(funcname, funclist) {
  for (var i = 0; i < funclist.length; i++) {
    if (funcname.toLowerCase() == funclist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function mutate_n(n, ratio){
  return n + Math.floor(Math.random() * ratio) - ratio/2;
}

function mutate_buf(ptr, size, arg_i) {
  let buf = Memory.readByteArray(ptr, size);
  let buf_view = new Uint8Array(buf);
  // deep copy buf
  let new_buf = new ArrayBuffer(size);
  let new_buf_view = new Uint8Array(new_buf);
  for (let i = 0; i < size; i++) {
      if (Math.random() < 0.9) {
        new_buf_view[i] = buf_view[i];
      }else{
        new_buf_view[i] = mutate_n(buf_view[i], 10)
        }
    }
  Memory.writeByteArray(ptr, new_buf_view);
  console.log("Mutating buffer arg " + arg_i);
  console.log("From:");
  console.log(buf);
  console.log("To:");
  console.log(new_buf);
}

function mutate_args(context, args, f_args_infos) {
  let syscall_args = ["rcx", "rdx", "r8", "r9"];
  for (let i = 0; i < args.length; i++) {
    if (Memory.readPointer(args[i]) != 0 && Math.random() < 0.4) {
       mutate_buf(Memory.readPointer(args[i]), 0x100, i);
    }
    else if (i < syscall_args.length && Math.random() < 0.15 ) {
        let reg_name = syscall_args[i];
        // convert to int
        let reg_val = parseInt(args[i]);
        let new_val = mutate_n(reg_val, 10000);
        context[reg_name] = new_val;
        let hex_val = "0x" + new_val.toString(16);
        console.log("Mutating " + reg_name + " from " + args[i] + " to " + hex_val);
    }
  }
}


setTimeout(function() {
  Process.enumerateModules({
    onMatch: function(module) {
      //console.log("Found " + module.name + " at " + module.base);
      if (lib_includes(module.name, Object.keys(sys_data))) {
        let exports = module.enumerateExports();
        let module_name = module.name.toLowerCase();
        for (let f_name in sys_data[module_name]) {
          // call random function
          
          let infos = sys_data[module_name][f_name];
          let ea = infos["addr"]
          ea = module.base.add(ptr(ea));
          funcs_map[ea] = [f_name, module.name]
          try {
            //console.log("Hooking " + f_name + " at " + ea);
            Interceptor.attach(ea, {
              onEnter: function(args) {
                let f_name = funcs_map[this.context.pc][0];
                let module_name = funcs_map[this.context.pc][1];
                console.log(f_name); 
                let rcx = this.context.rcx;
                let rdx = this.context.rdx;
                let r8 = this.context.r8;
                let r9 = this.context.r9;
                let syscall_args = [rcx, rdx, r8, r9];
                let arg_index = 0;
                let stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                while (stack_arg != 0 && arg_index < 4) {
                  stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                  syscall_args.push(stack_arg);
                  arg_index++;
                }
                let f_args_infos = sys_data[module_name][f_name]["args"];
                for (let i = 0; i < syscall_args.length; i++) {
                  let arg_info = "";
                  if (i < f_args_infos.length) {
                    arg_info = f_args_infos[i];
                  }
                  console.log("Arg " + i + ": " + " " + arg_info + " " + syscall_args[i]);
                }
                mutate_args(this.context, syscall_args, f_args_infos);
                
              }
            });
          } catch (e) {
            console.log("Error: " + e);
          }
        }
      }
    },
    onComplete: function() {
    }
  });
}, 500);
