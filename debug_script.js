
var sys_data = {"ntdll.dll": {"sub_9EF10": {"args": [], "addr": 651024}, "ZwWriteFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ PFILE_SEGMENT_ELEMENT SegmentArray", "_In_ ULONG Length", "_In_opt_ PLARGE_INTEGER ByteOffset", "_In_opt_ PULONG Key"], "addr": 652384}, "ZwReleaseSemaphore": {"args": ["_In_ HANDLE SemaphoreHandle", "_In_ LONG ReleaseCount", "_Out_opt_ PLONG PreviousCount"], "addr": 652448}, "ZwFindAtom": {"args": ["_In_reads_bytes_opt_(Length) PWSTR AtomName", "_In_ ULONG Length", "_Out_opt_ PRTL_ATOM Atom"], "addr": 652768}, "ZwQueryKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_INFORMATION_CLASS KeyInformationClass", "_Out_writes_bytes_opt_(Length) PVOID KeyInformation", "_In_ ULONG Length", "_Out_ PULONG ResultLength"], "addr": 652832}, "ZwSetInformationProcess": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PROCESSINFOCLASS ProcessInformationClass", "_In_reads_bytes_opt_(ProcessInformationLength) PVOID ProcessInformation", "_In_ ULONG ProcessInformationLength"], "addr": 653024}, "ZwCreateKey": {"args": ["_Out_ PHANDLE KeyedEventHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG Flags"], "addr": 653056}, "ZwUnmapViewOfSection": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ PVOID BaseAddress"], "addr": 653472}, "ZwTerminateProcess": {"args": ["_In_opt_ HANDLE ProcessHandle", "_In_ NTSTATUS ExitStatus"], "addr": 653536}, "ZwQueryDirectoryFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID FileInformation", "_In_ ULONG Length", "_In_ FILE_INFORMATION_CLASS FileInformationClass", "_In_ BOOLEAN ReturnSingleEntry", "_In_opt_ PUNICODE_STRING FileName", "_In_ BOOLEAN RestartScan"], "addr": 653824}, "ZwQuerySystemInformation": {"args": ["_In_ SYSTEM_INFORMATION_CLASS SystemInformationClass", "_Out_writes_bytes_to_opt_(SystemInformationLength,*ReturnLength) PVOID SystemInformation", "_In_ ULONG SystemInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 653856}, "ZwContinue": {"args": ["_In_ PCONTEXT ContextRecord", "_In_ BOOLEAN TestAlert"], "addr": 654272}, "ZwCreateEvent": {"args": ["_Out_ PHANDLE EventHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ EVENT_TYPE EventType", "_In_ BOOLEAN InitialState"], "addr": 654432}, "ZwQueryVolumeInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID FsInformation", "_In_ ULONG Length", "_In_ FS_INFORMATION_CLASS FsInformationClass"], "addr": 654464}, "ZwFlushBuffersFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock"], "addr": 654528}, "ZwIsProcessInJob": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ HANDLE JobHandle"], "addr": 654656}, "ZwAcquireCrossVmMutant": {"args": [], "addr": 655408}, "ZwAcquireProcessActivityReference": {"args": [], "addr": 655440}, "ZwAddDriverEntry": {"args": ["_In_ PEFI_DRIVER_ENTRY DriverEntry", "_Out_opt_ PULONG Id"], "addr": 655536}, "ZwAlpcCancelMessage": {"args": ["_In_ HANDLE PortHandle", "_In_ ULONG Flags", "_In_ PALPC_CONTEXT_ATTR MessageContext"], "addr": 655952}, "ZwAlpcCreatePortSection": {"args": ["_In_ HANDLE PortHandle", "_In_ ULONG Flags", "_In_opt_ HANDLE SectionHandle", "_In_ SIZE_T SectionSize", "_Out_ PALPC_HANDLE AlpcSectionHandle", "_Out_ PSIZE_T ActualSectionSize"], "addr": 656080}, "ZwAlpcQueryInformation": {"args": ["_In_opt_ HANDLE PortHandle", "_In_ __drv_strictTypeMatch(__drv_typeConst) ALPC_PORT_INFORMATION_CLASS PortInformationClass", "_Inout_updates_bytes_to_(Length,*ReturnLength) PVOID PortInformation", "_In_ ULONG Length", "_Out_opt_ PULONG ReturnLength"], "addr": 656496}, "ZwCancelWaitCompletionPacket": {"args": ["_In_ HANDLE WaitCompletionPacketHandle", "_In_ BOOLEAN RemoveSignaledPacket"], "addr": 656880}, "ZwCommitComplete": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 656976}, "ZwCompactKeys": {"args": ["_In_ ULONG Count", "_In_reads_(Count) HANDLE KeyArray[]"], "addr": 657104}, "ZwCompareObjects": {"args": ["_In_ HANDLE FirstObjectHandle", "_In_ HANDLE SecondObjectHandle"], "addr": 657136}, "ZwCreateJobSet": {"args": ["_In_ ULONG NumJob", "_In_reads_(NumJob) PJOB_SET_ARRAY UserJobSet", "_In_ ULONG Flags"], "addr": 657840}, "ZwCreateKeyTransacted": {"args": ["_Out_ PHANDLE KeyHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Reserved_ ULONG TitleIndex", "_In_opt_ PUNICODE_STRING Class", "_In_ ULONG CreateOptions", "_In_ HANDLE TransactionHandle", "_Out_opt_ PULONG Disposition"], "addr": 657872}, "ZwCreateKeyedEvent": {"args": ["_Out_ PHANDLE KeyedEventHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG Flags"], "addr": 657904}, "ZwCreatePagingFile": {"args": ["_In_ PUNICODE_STRING PageFileName", "_In_ PLARGE_INTEGER MinimumSize", "_In_ PLARGE_INTEGER MaximumSize", "_In_ ULONG Flags"], "addr": 658064}, "ZwCreatePartition": {"args": ["_In_opt_ HANDLE ParentPartitionHandle", "_Out_ PHANDLE PartitionHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG PreferredNode"], "addr": 658096}, "ZwCreatePrivateNamespace": {"args": ["_Out_ PHANDLE NamespaceHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ PVOID BoundaryDescriptor"], "addr": 658160}, "ZwCreateProfileEx": {"args": ["_Out_ PHANDLE ProfileHandle", "_In_ HANDLE Process OPTIONAL", "_In_ PVOID ProfileBase", "_In_ SIZE_T ProfileSize", "_In_ ULONG BucketSize", "_In_reads_bytes_(BufferSize) PULONG Buffer", "_In_ ULONG BufferSize", "_In_ KPROFILE_SOURCE ProfileSource", "_In_ USHORT GroupCount", "_In_reads_(GroupCount) PGROUP_AFFINITY AffinityArray"], "addr": 658288}, "ZwCreateSectionEx": {"args": [], "addr": 658384}, "ZwCreateSemaphore": {"args": ["_Out_ PHANDLE SemaphoreHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ LONG InitialCount", "_In_ LONG MaximumCount"], "addr": 658416}, "ZwCreateTransaction": {"args": ["_Out_ PHANDLE TmHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PUNICODE_STRING LogFileName", "_In_opt_ ULONG CreateOptions", "_In_opt_ ULONG CommitStrength"], "addr": 658672}, "ZwCreateWorkerFactory": {"args": [], "addr": 658864}, "ZwDebugActiveProcess": {"args": [], "addr": 658896}, "ZwDeleteAtom": {"args": ["_In_ RTL_ATOM Atom"], "addr": 658960}, "ZwDeleteBootEntry": {"args": ["_In_ ULONG Id"], "addr": 658992}, "ZwDeleteKey": {"args": ["_In_ HANDLE KeyHandle"], "addr": 659088}, "ZwDeleteWnfStateData": {"args": ["_In_ PCWNF_STATE_NAME StateName", "_In_opt_ const PVOID ExplicitScope"], "addr": 659216}, "ZwEnumerateSystemEnvironmentValuesEx": {"args": ["_In_ ULONG InformationClass", "_Out_ PVOID Buffer", "_Inout_ PULONG BufferLength"], "addr": 659504}, "ZwExtendSection": {"args": ["_In_ HANDLE SectionHandle", "_Inout_ PLARGE_INTEGER NewSectionSize"], "addr": 659568}, "ZwFlushKey": {"args": ["_In_ HANDLE KeyHandle"], "addr": 659792}, "ZwGetCompleteWnfStateSubscription": {"args": ["_In_opt_ PWNF_STATE_NAME OldDescriptorStateName", "_In_opt_ ULONG64 *OldSubscriptionId", "_In_opt_ ULONG OldDescriptorEventMask", "_In_opt_ ULONG OldDescriptorStatus", "_Out_writes_bytes_(DescriptorSize) PWNF_DELIVERY_DESCRIPTOR NewDeliveryDescriptor", "_In_ ULONG DescriptorSize"], "addr": 660048}, "ZwGetWriteWatch": {"args": ["_In_ HANDLE ProcessHandle", "_In_ ULONG Flags", "_In_ PVOID BaseAddress", "_In_ SIZE_T RegionSize", "_Out_writes_opt_(*EntriesInUserAddressArray) PVOID *UserAddressArray", "_Inout_opt_ PULONG_PTR EntriesInUserAddressArray", "_Out_opt_ PULONG Granularity"], "addr": 660368}, "ZwInitializeEnclave": {"args": [], "addr": 660464}, "ZwInitiatePowerAction": {"args": ["_In_ POWER_ACTION SystemAction", "_In_ SYSTEM_POWER_STATE LightestSystemState", "_In_ ULONG Flags,        // POWER_ACTION_xxx flags\n  _In_ BOOLEAN Asynchronous"], "addr": 660560}, "ZwIsSystemResumeAutomatic": {"args": [], "addr": 660592}, "ZwListenPort": {"args": ["_In_ HANDLE PortHandle", "_Out_ PPORT_MESSAGE ConnectionRequest"], "addr": 660656}, "ZwLoadDriver": {"args": ["_In_ PUNICODE_STRING DriverServiceName"], "addr": 660688}, "ZwLoadKey": {"args": ["_In_ POBJECT_ATTRIBUTES TargetKey", "_In_ POBJECT_ATTRIBUTES SourceFile"], "addr": 660752}, "ZwMakePermanentObject": {"args": ["_In_ HANDLE Handle"], "addr": 661008}, "ZwManageHotPatch": {"args": [], "addr": 661072}, "ZwMapUserPhysicalPages": {"args": ["_In_ PVOID VirtualAddress", "_In_ ULONG_PTR NumberOfPages", "_In_reads_opt_(NumberOfPages) PULONG_PTR UserPfnArray"], "addr": 661168}, "ZwMapViewOfSectionEx": {"args": [], "addr": 661200}, "ZwOpenJobObject": {"args": ["_Out_ PHANDLE JobHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661584}, "ZwOpenObjectAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_opt_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_ HANDLE ClientToken", "_In_ ACCESS_MASK DesiredAccess", "_In_ ACCESS_MASK GrantedAccess", "_In_opt_ PPRIVILEGE_SET Privileges", "_In_ BOOLEAN ObjectCreation", "_In_ BOOLEAN AccessGranted", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 661776}, "ZwOpenPrivateNamespace": {"args": ["_Out_ PHANDLE NamespaceHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ PVOID BoundaryDescriptor"], "addr": 661840}, "ZwOpenResourceManager": {"args": ["_Out_ PHANDLE ResourceManagerHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ HANDLE TmHandle", "_In_opt_ LPGUID ResourceManagerGuid", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661936}, "ZwOpenSymbolicLinkObject": {"args": ["_Out_ PHANDLE LinkHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 662032}, "ZwOpenTransactionManager": {"args": ["_Out_ PHANDLE TmHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PUNICODE_STRING LogFileName", "_In_opt_ LPGUID TmIdentity", "_In_opt_ ULONG OpenOptions"], "addr": 662160}, "ZwPrePrepareComplete": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 662224}, "ZwPrePrepareEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 662256}, "ZwPssCaptureVaSpaceBulk": {"args": [], "addr": 662512}, "ZwQueryFullAttributesFile": {"args": ["_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Out_ PFILE_NETWORK_OPEN_INFORMATION FileInformation"], "addr": 662832}, "ZwQueryInformationByName": {"args": [], "addr": 662896}, "ZwQueryInformationEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_ ENLISTMENT_INFORMATION_CLASS EnlistmentInformationClass", "_Out_writes_bytes_(EnlistmentInformationLength) PVOID EnlistmentInformation", "_In_ ULONG EnlistmentInformationLength", "_Out_ PULONG ReturnLength"], "addr": 662960}, "ZwQueryInformationJobObject": {"args": ["_In_opt_ HANDLE JobHandle", "_In_ JOBOBJECTINFOCLASS JobObjectInformationClass", "_Out_writes_bytes_(JobObjectInformationLength) PVOID JobObjectInformation", "_In_ ULONG JobObjectInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 662992}, "ZwQueryInformationResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle", "_In_ RESOURCEMANAGER_INFORMATION_CLASS ResourceManagerInformationClass", "_Out_writes_bytes_(ResourceManagerInformationLength) PVOID ResourceManagerInformation", "_In_ ULONG ResourceManagerInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 663056}, "ZwQueryIoCompletion": {"args": ["_In_ HANDLE IoCompletionHandle", "_In_ IO_COMPLETION_INFORMATION_CLASS IoCompletionInformationClass", "_Out_writes_bytes_(IoCompletionInformationLength) PVOID IoCompletionInformation", "_In_ ULONG IoCompletionInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 663248}, "ZwQueryPortInformationProcess": {"args": ["VOID"], "addr": 663472}, "ZwQuerySemaphore": {"args": ["_In_ HANDLE SemaphoreHandle", "_In_ SEMAPHORE_INFORMATION_CLASS SemaphoreInformationClass", "_Out_writes_bytes_(SemaphoreInformationLength) PVOID SemaphoreInformation", "_In_ ULONG SemaphoreInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 663632}, "ZwQuerySystemEnvironmentValueEx": {"args": ["_In_ PUNICODE_STRING VariableName", "_In_ LPGUID VendorGuid", "_Out_writes_bytes_opt_(*ValueLength) PVOID Value", "_Inout_ PULONG ValueLength", "_Out_opt_ PULONG Attributes"], "addr": 663728}, "ZwQueryWnfStateData": {"args": ["_In_ PCWNF_STATE_NAME StateName", "_In_opt_ PCWNF_TYPE_ID TypeId", "_In_opt_ const VOID* ExplicitScope", "_Out_ PWNF_CHANGE_STAMP ChangeStamp", "_Out_writes_bytes_to_opt_(*BufferSize,*BufferSize) PVOID Buffer", "_Inout_ PULONG BufferSize"], "addr": 663824}, "ZwQueueApcThreadEx": {"args": ["_In_ HANDLE ThreadHandle", "_In_opt_ HANDLE UserApcReserveHandle", "_In_ PPS_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcArgument1", "_In_opt_ PVOID ApcArgument2", "_In_opt_ PVOID ApcArgument3"], "addr": 663888}, "ZwReadOnlyEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 664016}, "ZwRecoverResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle"], "addr": 664112}, "ZwReleaseWorkerFactoryWorker": {"args": [], "addr": 664272}, "ZwRenameKey": {"args": ["_In_ HANDLE      KeyHandle", "_In_ PUNICODE_STRING NewName"], "addr": 664368}, "ZwRequestPort": {"args": ["_In_ HANDLE PortHandle", "_In_reads_bytes_(RequestMessage->u1.s1.TotalLength) PPORT_MESSAGE RequestMessage"], "addr": 664528}, "ZwResetWriteWatch": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PVOID BaseAddress", "_In_ SIZE_T RegionSize"], "addr": 664592}, "ZwResumeProcess": {"args": ["_In_ HANDLE ProcessHandle"], "addr": 664656}, "ZwSaveKeyEx": {"args": ["_In_ HANDLE KeyHandle", "_In_ HANDLE FileHandle", "_In_ ULONG Format"], "addr": 664912}, "ZwSaveMergedKeys": {"args": ["_In_ HANDLE HighPrecedenceKeyHandle", "_In_ HANDLE LowPrecedenceKeyHandle", "_In_ HANDLE FileHandle"], "addr": 664944}, "ZwSecureConnectPort": {"args": ["_Out_ PHANDLE PortHandle", "_In_ PUNICODE_STRING PortName", "_In_ PSECURITY_QUALITY_OF_SERVICE SecurityQos", "_Inout_opt_ PPORT_VIEW ClientView", "_In_opt_ PSID RequiredServerSid", "_Inout_opt_ PREMOTE_PORT_VIEW ServerView", "_Out_opt_ PULONG MaxMessageLength", "_Inout_updates_bytes_to_opt_(*ConnectionInformationLength,*ConnectionInformationLength) PVOID ConnectionInformation", "_Inout_opt_ PULONG ConnectionInformationLength"], "addr": 664976}, "ZwSetCachedSigningLevel2": {"args": [], "addr": 665136}, "ZwSetInformationVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_In_ VIRTUAL_MEMORY_INFORMATION_CLASS VmInformationClass", "_In_ ULONG_PTR NumberOfEntries", "_In_reads_ (NumberOfEntries) PMEMORY_RANGE_ENTRY VirtualAddresses", "_In_reads_bytes_ (VmInformationLength) PVOID VmInformation", "_In_ ULONG VmInformationLength"], "addr": 665840}, "ZwSetIoCompletion": {"args": ["_In_ HANDLE IoCompletionHandle", "_In_opt_ PVOID KeyContext", "_In_opt_ PVOID ApcContext", "_In_ NTSTATUS IoStatus", "_In_ ULONG_PTR IoStatusInformation"], "addr": 665936}, "ZwSetIoCompletionEx": {"args": ["_In_ HANDLE IoCompletionHandle", "_In_ HANDLE IoCompletionPacketHandle", "_In_opt_ PVOID KeyContext", "_In_opt_ PVOID ApcContext", "_In_ NTSTATUS IoStatus", "_In_ ULONG_PTR IoStatusInformation"], "addr": 665968}, "ZwSetSystemInformation": {"args": ["_In_ SYSTEM_INFORMATION_CLASS SystemInformationClass", "_In_reads_bytes_opt_(SystemInformationLength) PVOID SystemInformation", "_In_ ULONG SystemInformationLength"], "addr": 666224}, "ZwSetVolumeInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_reads_bytes_(Length) PVOID FsInformation", "_In_ ULONG Length", "_In_ FS_INFORMATION_CLASS FsInformationClass"], "addr": 666480}, "ZwStartProfile": {"args": ["_In_ HANDLE ProfileHandle"], "addr": 666672}, "ZwStopProfile": {"args": ["_In_ HANDLE ProfileHandle"], "addr": 666704}, "ZwSubscribeWnfStateChange": {"args": ["_In_ PCWNF_STATE_NAME StateName", "_In_opt_ WNF_CHANGE_STAMP ChangeStamp", "_In_ ULONG EventMask", "_Out_opt_ PULONG64 SubscriptionId"], "addr": 666768}, "ZwSystemDebugControl": {"args": ["_In_ SYSDBG_COMMAND Command", "_Inout_updates_bytes_opt_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(OutputBufferLength) PVOID OutputBuffer", "_In_ ULONG OutputBufferLength", "_Out_opt_ PULONG ReturnLength"], "addr": 666864}, "ZwUnlockVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_Inout_ PVOID *BaseAddress", "_Inout_ PSIZE_T RegionSize", "_In_ ULONG MapType"], "addr": 667312}, "ZwWaitForWorkViaWorkerFactory": {"args": [], "addr": 667568}, "ZwWaitHighEventPair": {"args": ["_In_ HANDLE EventPairHandle"], "addr": 667600}, "ZwWaitLowEventPair": {"args": ["_In_ HANDLE EventPairHandle"], "addr": 667632}}, "win32u.dll": {"NtUserPeekMessage": {"args": [], "addr": 5312}, "NtUserGetAsyncKeyState": {"args": [], "addr": 7296}, "NtUserDrawIconEx": {"args": [], "addr": 8160}, "NtGdiCreateBitmap": {"args": ["_In_ HDC hdc", "_In_ UINT uiWidth", "_In_ UINT uiHeight", "_In_ DWORD Format", "_In_opt_ HANDLE hDxSharedSurface"], "addr": 8544}, "NtUserFindWindowEx": {"args": [], "addr": 8576}, "NtUserSetParent": {"args": [], "addr": 8864}, "NtGdiOffsetRgn": {"args": ["_In_ HRGN hrgn", "_In_ int cx", "_In_ int cy"], "addr": 9056}, "NtGdiUnrealizeObject": {"args": ["_In_ HANDLE h"], "addr": 9568}, "NtGdiGetTextExtent": {"args": ["_In_ HDC hdc", "_In_reads_opt_(cwc) LPWSTR lpwsz", "_In_ ULONG cwc", "_In_ ULONG dxMax", "_Out_opt_ ULONG *pcCh, // range(0,cwc)\n  _Out_writes_to_opt_(cwc,*pcCh) PULONG pdxOut", "_Out_ LPSIZE psize", "_In_ FLONG fl"], "addr": 9760}, "NtUserGetAtomName": {"args": [], "addr": 10272}, "NtGdiGetPixel": {"args": ["_In_ HDC hdc", "_In_ int x", "_In_ int y"], "addr": 10944}, "NtUserGetMenuBarInfo": {"args": [], "addr": 11008}, "NtUserInvalidateRgn": {"args": [], "addr": 11104}, "NtGdiGetFontData": {"args": ["_In_ HDC hdc", "_In_ DWORD dwTable", "_In_ DWORD dwOffset", "_Out_writes_bytes_to_opt_(cjBuf,return) PVOID pvBuf", "_In_ ULONG cjBuf"], "addr": 11552}, "NtUserGetGUIThreadInfo": {"args": [], "addr": 12832}, "NtUserThunkedMenuInfo": {"args": [], "addr": 13120}, "NtUserCountClipboardFormats": {"args": [], "addr": 13312}, "NtUserActivateKeyboardLayout": {"args": [], "addr": 13792}, "NtDCompositionConnectPipe": {"args": [], "addr": 14304}, "NtDCompositionGetFrameId": {"args": [], "addr": 14816}, "NtDCompositionGetFrameSurfaceUpdates": {"args": [], "addr": 14944}, "NtDCompositionGetMaterialProperty": {"args": [], "addr": 14976}, "NtDCompositionReleaseAllResources": {"args": [], "addr": 15232}, "NtDCompositionWaitForCompositorClock": {"args": [], "addr": 15680}, "NtDxgkEnumAdapters3": {"args": [], "addr": 16128}, "NtDxgkResetTrackedWorkloadStatistics": {"args": [], "addr": 16480}, "NtDxgkSetProperties": {"args": [], "addr": 16512}, "NtFlipObjectConsumerEndProcessPresent": {"args": [], "addr": 16960}, "NtFlipObjectQueryBufferAvailableEvent": {"args": [], "addr": 17216}, "NtGdiBRUSHOBJ_DeleteRbrush": {"args": ["_In_opt_ BRUSHOBJ *pbo", "_In_opt_ BRUSHOBJ *pboB"], "addr": 17792}, "NtGdiCLIPOBJ_bEnum": {"args": ["_In_ CLIPOBJ *pco", "_In_ ULONG cj", "_Out_writes_bytes_(cj) ULONG *pul"], "addr": 17984}, "NtGdiCreateOPMProtectedOutputs": {"args": [], "addr": 18560}, "NtGdiCreateRoundRectRgn": {"args": ["_In_ int xLeft", "_In_ int yTop", "_In_ int xRight", "_In_ int yBottom", "_In_ int xWidth", "_In_ int yHeight"], "addr": 18592}, "NtGdiDdCreateFullscreenSprite": {"args": ["_In_ HDC hdc", "_In_ COLORREF crKey", "_Out_ HANDLE* phSprite", "_Out_ HDC* phdcSprite"], "addr": 18880}, "NtGdiDdDDIAddSurfaceToSwapChain": {"args": [], "addr": 19040}, "NtGdiDdDDIDispMgrSourceOperation": {"args": [], "addr": 20480}, "NtGdiDdDDIMakeResident": {"args": [], "addr": 21760}, "NtGdiDdDDINetDispGetNextChunkInfo": {"args": [], "addr": 21856}, "NtGdiDdDDIReleaseSwapChain": {"args": [], "addr": 23488}, "NtGdiDdDDIReserveGpuVirtualAddress": {"args": [], "addr": 23584}, "NtGdiDdDDISubmitSignalSyncObjectsToHwQueue": {"args": [], "addr": 24544}, "NtGdiDdDDIWaitForSynchronizationObject": {"args": [], "addr": 24864}, "NtGdiDdDestroyFullscreenSprite": {"args": ["_In_ HDC hdc", "_In_ HANDLE hSprite"], "addr": 25024}, "NtGdiDestroyOPMProtectedOutput": {"args": [], "addr": 25184}, "NtGdiDrawEscape": {"args": ["_In_ HDC hdc", "_In_ int iEsc", "_In_ int cjIn", "_In_reads_bytes_opt_(cjIn) LPSTR pjIn"], "addr": 25280}, "NtGdiEnableEudc": {"args": ["_In_ BOOL"], "addr": 25376}, "NtGdiEngEraseSurface": {"args": ["_In_ SURFOBJ *pso", "_In_ RECTL *prcl", "_In_ ULONG iColor"], "addr": 25984}, "NtGdiEngStretchBltROP": {"args": ["_In_ SURFOBJ *psoTrg", "_In_ SURFOBJ *psoSrc", "_In_ SURFOBJ *psoMask", "_In_ CLIPOBJ *pco", "_In_ XLATEOBJ *pxlo", "_In_ COLORADJUSTMENT *pca", "_In_ POINTL *pptlBrushOrg", "_In_ RECTL *prclTrg", "_In_ RECTL *prclSrc", "_In_ POINTL *pptlMask", "_In_ ULONG iMode", "_In_ BRUSHOBJ *pbo", "_In_ ROP4 rop4"], "addr": 26272}, "NtGdiEnsureDpiDepDefaultGuiFontForPlateau": {"args": ["_In_ int iDpi"], "addr": 26464}, "NtGdiGetEntry": {"args": ["_In_ int index", "_Out_writes_bytes_(ENTRY_SIZE) PVOID pEntry"], "addr": 27680}, "NtGdiGetFontResourceInfoInternalW": {"args": ["_In_reads_(cwc) LPWSTR pwszFiles", "_In_ ULONG cwc", "_In_ ULONG cFiles", "_In_ UINT cjIn", "_Out_ LPDWORD pdwBytes", "_Out_writes_bytes_(cjIn) LPVOID pvBuf", "_In_ DWORD iType"], "addr": 27808}, "NtGdiGetKerningPairs": {"args": ["_In_ HDC hdc", "_In_ ULONG cPairs", "_Out_writes_to_opt_(cPairs,return) KERNINGPAIR *pkpDst"], "addr": 27968}, "NtGdiIcmBrushInfo": {"args": ["_In_ HDC hdc", "_In_ HBRUSH hbrush", "_Inout_updates_bytes_(sizeof(BITMAPINFO) + ((/*MAX_COLORTABLE*/256 - 1) * sizeof(RGBQUAD))) PBITMAPINFO pbmiDIB", "_Inout_updates_bytes_(*pulBits) PVOID pvBits", "_Inout_ ULONG *pulBits", "_Out_opt_ DWORD *piUsage", "_Out_opt_ BOOL *pbAlreadyTran", "_In_ ULONG Command"], "addr": 28864}, "NtGdiPATHOBJ_vEnumStartClipLines": {"args": ["_In_ PATHOBJ *ppo", "_In_ CLIPOBJ *pco", "_In_ SURFOBJ *pso", "_In_ LINEATTRS *pla"], "addr": 29312}, "NtGdiPathToRegion": {"args": ["_In_ HDC hdc"], "addr": 29376}, "NtGdiSTROBJ_bEnum": {"args": ["_In_ STROBJ *pstro", "_Out_ ULONG *pc", "_Outptr_result_buffer_(*pc) PGLYPHPOS *ppgpos"], "addr": 29760}, "NtGdiSetColorAdjustment": {"args": ["_In_ HDC hdc", "_In_ PCOLORADJUSTMENT pca"], "addr": 30208}, "NtGdiSetMagicColors": {"args": ["_In_ HDC hdc", "_In_ PALETTEENTRY peMagic", "_In_ ULONG Index"], "addr": 30368}, "NtGdiSetOPMSigningKeyAndSequenceNumbers": {"args": [], "addr": 30400}, "NtGdiSetPixelFormat": {"args": ["_In_ HDC hdc", "_In_ int ipfd"], "addr": 30464}, "NtGdiXLATEOBJ_hGetColorTransform": {"args": ["_In_ XLATEOBJ *pxlo"], "addr": 31168}, "NtMITDisableMouseIntercept": {"args": [], "addr": 31584}, "NtMITPrepareReceiveInputMessage": {"args": [], "addr": 31904}, "NtMITSetInputObservationState": {"args": [], "addr": 32064}, "NtMinGetInputTransform": {"args": [], "addr": 32384}, "NtModerncoreIdleTimerThread": {"args": [], "addr": 32832}, "NtRIMQueryDevicePath": {"args": [], "addr": 33984}, "NtRIMSetExtendedDeviceProperty": {"args": [], "addr": 34144}, "NtUserBuildHimcList": {"args": [], "addr": 35296}, "NtUserCheckImeShowStatusInThread": {"args": [], "addr": 35584}, "NtUserCitSetInfo": {"args": [], "addr": 35744}, "NtUserCreateWindowStation": {"args": [], "addr": 36384}, "NtUserDoSoundConnect": {"args": [], "addr": 37120}, "NtUserDwmLockScreenUpdates": {"args": [], "addr": 37632}, "NtUserGetAutoRotationState": {"args": [], "addr": 38592}, "NtUserGetCaretPos": {"args": [], "addr": 38656}, "NtUserGetDCompositionHwndBitmap": {"args": [], "addr": 39040}, "NtUserGetInputLocaleInfo": {"args": [], "addr": 39776}, "NtUserGetMessagePos": {"args": [], "addr": 40192}, "NtUserGetModernAppWindow": {"args": [], "addr": 40256}, "NtUserGetOemBitmapSize": {"args": [], "addr": 40320}, "NtUserGetPointerFrameTimes": {"args": [], "addr": 40640}, "NtUserGetSharedWindowData": {"args": [], "addr": 41344}, "NtUserGetSystemContentRects": {"args": [], "addr": 41408}, "NtUserHiliteMenuItem": {"args": [], "addr": 42272}, "NtUserInitializePointerDeviceInjectionEx": {"args": [], "addr": 42720}, "NtUserMapDesktopObject": {"args": [], "addr": 44000}, "NtUserMapPointsByVisualIdentifier": {"args": [], "addr": 44032}, "NtUserMessageBeep": {"args": [], "addr": 44128}, "NtUserPrepareForLogoff": {"args": [], "addr": 44704}, "NtUserPromotePointer": {"args": [], "addr": 44832}, "NtUserRealChildWindowFromPoint": {"args": [], "addr": 45024}, "NtUserScheduleDispatchNotification": {"args": [], "addr": 46976}, "NtUserSendInteractiveControlHapticsReport": {"args": [], "addr": 47040}, "NtUserSetImeInfoEx": {"args": [], "addr": 48192}, "NtUserSetInteractiveControlFocus": {"args": [], "addr": 48288}, "NtUserSetMirrorRendering": {"args": [], "addr": 48608}, "NtUserSetWindowRgnEx": {"args": [], "addr": 49824}, "NtUserShellSetWindowPos": {"args": [], "addr": 50112}, "NtUserSwapMouseButton": {"args": [], "addr": 50496}, "NtUserTestForInteractiveUser": {"args": [], "addr": 50624}, "NtUserUnregisterSessionPort": {"args": [], "addr": 50976}, "NtUserValidateHandleSecure": {"args": [], "addr": 51456}, "NtValidateCompositionSurfaceHandle": {"args": [], "addr": 51744}}};
var funcs_map = {};
var register_args = ["rcx", "rdx", "r8", "r9"];

function lib_includes(libname, liblist) {
  for (var i = 0; i < liblist.length; i++) {
    if (libname.toLowerCase() == liblist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function func_includes(funcname, funclist) {
  for (var i = 0; i < funclist.length; i++) {
    if (funcname.toLowerCase() == funclist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function mutate_n(n, ratio){
  return n + Math.floor(Math.random() * ratio) - ratio/2;
}

function mutate_buf(ptr, size, arg_i) {
  let buf = Memory.readByteArray(ptr, size);
  let buf_view = new Uint8Array(buf);
  // deep copy buf
  let new_buf = new ArrayBuffer(size);
  let new_buf_view = new Uint8Array(new_buf);
  for (let i = 0; i < size; i++) {
      if (Math.random() < 0.7) {
        new_buf_view[i] = buf_view[i];
      }else{
        new_buf_view[i] = mutate_n(buf_view[i], 10)
        }
    }
  Memory.writeByteArray(ptr, new_buf_view);
  console.log("Mutating buffer arg " + arg_i);
  console.log("From:");
  console.log(buf);
  console.log("To:");
  console.log(new_buf);
}

function mutate_args(context, args, f_args_infos) {
  let syscall_args = ["rcx", "rdx", "r8", "r9"];
  for (let i = 0; i < args.length; i++) {
    if (Math.random() < 0.02) {
        try{
          Memory.readPointer(args[i]) 
          mutate_buf(Memory.readPointer(args[i]), 0x100, i);
        }catch(e){
          continue;
        }
    }
    else if (i < syscall_args.length && Math.random() < 0.01 ) {
        let reg_name = syscall_args[i];
        // convert to int
        let reg_val = parseInt(args[i]);
        let new_val = mutate_n(reg_val, 10000);
        context[reg_name] = new_val;
        let hex_val = "0x" + new_val.toString(16);
        console.log("Mutating " + reg_name + " from " + args[i] + " to " + hex_val);
    }
  }
}


setTimeout(function() {
  Process.enumerateModules({
    onMatch: function(module) {
      //console.log("Found " + module.name + " at " + module.base);
      if (lib_includes(module.name, Object.keys(sys_data))) {
        let exports = module.enumerateExports();
        let module_name = module.name.toLowerCase();
        for (let f_name in sys_data[module_name]) {
          // call random function
          
          let infos = sys_data[module_name][f_name];
          let ea = infos["addr"]
          ea = module.base.add(ptr(ea));
          funcs_map[ea] = [f_name, module.name]
          try {
            //console.log("Hooking " + f_name + " at " + ea);
            Interceptor.attach(ea, {
              onEnter: function(args) {
                let f_name = funcs_map[this.context.pc][0];
                let module_name = funcs_map[this.context.pc][1];
                console.log(f_name); 
                let rcx = this.context.rcx;
                let rdx = this.context.rdx;
                let r8 = this.context.r8;
                let r9 = this.context.r9;
                let syscall_args = [rcx, rdx, r8, r9];
                let arg_index = 0;
                let stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                while (stack_arg != 0 && arg_index < 4) {
                  stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                  syscall_args.push(stack_arg);
                  arg_index++;
                }
                let f_args_infos = sys_data[module_name][f_name]["args"];
                for (let i = 0; i < syscall_args.length; i++) {
                  let arg_info = "";
                  if (i < f_args_infos.length) {
                    arg_info = f_args_infos[i];
                  }
                  console.log("Arg " + i + ": " + " " + arg_info + " " + syscall_args[i]);
                }
                mutate_args(this.context, syscall_args, f_args_infos);
                
              }
            });
          } catch (e) {
            console.log("Error: " + e);
          }
        }
      }
    },
    onComplete: function() {
    }
  });
}, 500);
