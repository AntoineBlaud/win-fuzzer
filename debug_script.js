
var sys_data = {"ntdll.dll": {"sub_9EF70": {"args": [], "addr": 651120}, "ZwQueryInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID FileInformation", "_In_ ULONG Length", "_In_ FILE_INFORMATION_CLASS FileInformationClass"], "addr": 652672}, "ZwFindAtom": {"args": ["_In_reads_bytes_opt_(Length) PWSTR AtomName", "_In_ ULONG Length", "_Out_opt_ PRTL_ATOM Atom"], "addr": 652768}, "ZwQueryInformationProcess": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PROCESSINFOCLASS ProcessInformationClass", "_Out_writes_bytes_opt_(ProcessInformationLength) PVOID ProcessInformation", "_In_ ULONG ProcessInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 652928}, "ZwRequestWaitReplyPort": {"args": ["_In_ HANDLE PortHandle", "_In_reads_bytes_(RequestMessage->u1.s1.TotalLength) PPORT_MESSAGE RequestMessage", "_Out_ PPORT_MESSAGE ReplyMessage"], "addr": 653216}, "ZwQueryVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ PVOID BaseAddress", "_In_ MEMORY_INFORMATION_CLASS MemoryInformationClass", "_Out_writes_bytes_(MemoryInformationLength) PVOID MemoryInformation", "_In_ SIZE_T MemoryInformationLength", "_Out_opt_ PSIZE_T ReturnLength"], "addr": 653248}, "ZwSetInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_reads_bytes_(Length) PVOID FileInformation", "_In_ ULONG Length", "_In_ FILE_INFORMATION_CLASS FileInformationClass"], "addr": 653376}, "ZwAccessCheckAndAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_ ACCESS_MASK DesiredAccess", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_ PACCESS_MASK GrantedAccess", "_Out_ PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 653440}, "ZwQueryPerformanceCounter": {"args": ["_Out_ PLARGE_INTEGER PerformanceCounter", "_Out_opt_ PLARGE_INTEGER PerformanceFrequency"], "addr": 653696}, "ZwQuerySystemInformation": {"args": ["_In_ SYSTEM_INFORMATION_CLASS SystemInformationClass", "_Out_writes_bytes_to_opt_(SystemInformationLength,*ReturnLength) PVOID SystemInformation", "_In_ ULONG SystemInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 653856}, "ZwWriteVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ PVOID BaseAddress", "_In_reads_bytes_(BufferSize) CONST VOID *Buffer", "_In_ SIZE_T BufferSize", "_Out_opt_ PSIZE_T NumberOfBytesWritten"], "addr": 653984}, "ZwQueryAttributesFile": {"args": ["_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Out_ PFILE_BASIC_INFORMATION FileInformation"], "addr": 654080}, "ZwYieldExecution": {"args": ["VOID"], "addr": 654368}, "ZwQueryVolumeInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID FsInformation", "_In_ ULONG Length", "_In_ FS_INFORMATION_CLASS FsInformationClass"], "addr": 654464}, "ZwCancelIoFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock"], "addr": 655088}, "ZwSetTimer": {"args": ["_In_ HANDLE TimerHandle", "_In_ PLARGE_INTEGER DueTime", "_In_opt_ PTIMER_APC_ROUTINE TimerApcRoutine", "_In_opt_ PVOID TimerContext", "_In_ BOOLEAN ResumeTimer", "_In_opt_ LONG Period", "_Out_opt_ PBOOLEAN PreviousState"], "addr": 655248}, "ZwAcquireCrossVmMutant": {"args": [], "addr": 655408}, "ZwAlpcCancelMessage": {"args": ["_In_ HANDLE PortHandle", "_In_ ULONG Flags", "_In_ PALPC_CONTEXT_ATTR MessageContext"], "addr": 655952}, "ZwAlpcCreatePort": {"args": ["_Out_ PHANDLE PortHandle", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PALPC_PORT_ATTRIBUTES PortAttributes"], "addr": 656048}, "ZwAlpcCreateResourceReserve": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_In_ SIZE_T MessageSize", "_Out_ PULONG ResourceId"], "addr": 656112}, "ZwAlpcDeleteResourceReserve": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_In_ ULONG ResourceId"], "addr": 656240}, "ZwAlpcDeleteSectionView": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_In_ PVOID ViewBase"], "addr": 656272}, "ZwAlpcDeleteSecurityContext": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_In_ ALPC_HANDLE ContextHandle"], "addr": 656304}, "ZwAlpcOpenSenderProcess": {"args": ["_Out_ PHANDLE ProcessHandle", "_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE PortMessage", "_In_ ULONG Flags", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 656432}, "ZwAreMappedFilesTheSame": {"args": ["_In_ PVOID File1MappedAsAnImage", "_In_ PVOID File2MappedAsFile"], "addr": 656656}, "ZwCompactKeys": {"args": ["_In_ ULONG Count", "_In_reads_(Count) HANDLE KeyArray[]"], "addr": 657104}, "ZwCompareSigningLevels": {"args": [], "addr": 657168}, "ZwCreateJobSet": {"args": ["_In_ ULONG NumJob", "_In_reads_(NumJob) PJOB_SET_ARRAY UserJobSet", "_In_ ULONG Flags"], "addr": 657840}, "ZwCreateMailslotFile": {"args": ["_Out_ PHANDLE FileHandle", "_In_ ULONG DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ ULONG CreateOptions", "_In_ ULONG MailslotQuota", "_In_ ULONG MaximumMessageSize", "_In_ PLARGE_INTEGER ReadTimeout"], "addr": 657968}, "ZwCreateMutant": {"args": ["_Out_ PHANDLE MutantHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ BOOLEAN InitialOwner"], "addr": 658000}, "ZwCreateSemaphore": {"args": ["_Out_ PHANDLE SemaphoreHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ LONG InitialCount", "_In_ LONG MaximumCount"], "addr": 658416}, "ZwCreateTimer": {"args": ["_Out_ PHANDLE TimerHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ TIMER_TYPE TimerType"], "addr": 658544}, "ZwCreateUserProcess": {"args": ["_Out_ PHANDLE ProcessHandle", "_Out_ PHANDLE ThreadHandle", "_In_ ACCESS_MASK ProcessDesiredAccess", "_In_ ACCESS_MASK ThreadDesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ProcessObjectAttributes", "_In_opt_ POBJECT_ATTRIBUTES ThreadObjectAttributes", "_In_ ULONG ProcessFlags", "_In_ ULONG ThreadFlags", "_In_opt_ PVOID  ProcessParameters", "_Inout_ PPS_CREATE_INFO CreateInfo", "_In_opt_ PPS_ATTRIBUTE_LIST AttributeList"], "addr": 658736}, "ZwCreateWaitablePort": {"args": ["_Out_ PHANDLE PortHandle", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG MaxConnectionInfoLength", "_In_ ULONG MaxMessageLength", "_In_opt_ ULONG MaxPoolUsage"], "addr": 658800}, "ZwDeleteValueKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ PUNICODE_STRING ValueName"], "addr": 659184}, "ZwDrawText": {"args": ["_In_ PUNICODE_STRING String"], "addr": 659376}, "ZwEnableLastKnownGood": {"args": ["VOID"], "addr": 659408}, "ZwFlushInstallUILanguage": {"args": ["_In_ ULONG InstallUILanguage", "_In_ ULONG SetComittedFlag"], "addr": 659728}, "ZwFlushInstructionCache": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ PVOID BaseAddress", "_In_ SIZE_T Length"], "addr": 659760}, "ZwFlushWriteBuffer": {"args": ["VOID"], "addr": 659888}, "ZwGetCompleteWnfStateSubscription": {"args": ["_In_opt_ PWNF_STATE_NAME OldDescriptorStateName", "_In_opt_ ULONG64 *OldSubscriptionId", "_In_opt_ ULONG OldDescriptorEventMask", "_In_opt_ ULONG OldDescriptorStatus", "_Out_writes_bytes_(DescriptorSize) PWNF_DELIVERY_DESCRIPTOR NewDeliveryDescriptor", "_In_ ULONG DescriptorSize"], "addr": 660048}, "ZwGetDevicePowerState": {"args": ["_In_ HANDLE Device", "_Out_ PDEVICE_POWER_STATE State"], "addr": 660176}, "ZwGetNextThread": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ HANDLE ThreadHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ ULONG HandleAttributes", "_In_ ULONG Flags", "_Out_ PHANDLE NewThreadHandle"], "addr": 660272}, "ZwGetNotificationResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle", "_Out_ PTRANSACTION_NOTIFICATION TransactionNotification", "_In_ ULONG NotificationLength", "_In_opt_ PLARGE_INTEGER Timeout", "_Out_opt_ PULONG ReturnLength", "_In_ ULONG Asynchronous", "_In_opt_ ULONG_PTR AsynchronousContext"], "addr": 660336}, "ZwInitializeRegistry": {"args": ["_In_ USHORT BootCondition"], "addr": 660528}, "ZwLoadKey2": {"args": ["_In_ POBJECT_ATTRIBUTES  TargetKey", "_In_ POBJECT_ATTRIBUTES  SourceFile", "_In_ ULONG        Flags"], "addr": 660784}, "ZwLoadKeyEx": {"args": ["_In_ POBJECT_ATTRIBUTES   TargetKey", "_In_ POBJECT_ATTRIBUTES   SourceFile", "_In_ ULONG         Flags", "_In_opt_ HANDLE       TrustClassKey", "_In_opt_ HANDLE       Event", "_In_opt_ ACCESS_MASK    DesiredAccess", "_Out_opt_ PHANDLE      RootHandle", "_Out_opt_ PIO_STATUS_BLOCK IoStatus"], "addr": 660848}, "ZwMakePermanentObject": {"args": ["_In_ HANDLE Handle"], "addr": 661008}, "ZwMakeTemporaryObject": {"args": ["_In_ HANDLE Handle"], "addr": 661040}, "ZwNotifyChangeDirectoryFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID Buffer", "_In_ ULONG Length", "_In_ ULONG CompletionFilter", "_In_ BOOLEAN WatchTree"], "addr": 661296}, "ZwOpenEventPair": {"args": ["_Out_ PHANDLE EventPairHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661520}, "ZwOpenJobObject": {"args": ["_Out_ PHANDLE JobHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661584}, "ZwOpenKeyEx": {"args": ["_Out_ PHANDLE KeyHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG OpenOptions"], "addr": 661616}, "ZwOpenKeyTransactedEx": {"args": ["_Out_ PHANDLE KeyHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG OpenOptions", "_In_ HANDLE TransactionHandle"], "addr": 661680}, "ZwOpenResourceManager": {"args": ["_Out_ PHANDLE ResourceManagerHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ HANDLE TmHandle", "_In_opt_ LPGUID ResourceManagerGuid", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661936}, "ZwPrivilegedServiceAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_ PUNICODE_STRING ServiceName", "_In_ HANDLE ClientToken", "_In_ PPRIVILEGE_SET Privileges", "_In_ BOOLEAN AccessGranted"], "addr": 662416}, "ZwPropagationComplete": {"args": ["_In_ HANDLE ResourceManagerHandle", "_In_ ULONG RequestCookie", "_In_ ULONG BufferLength", "_In_ PVOID Buffer"], "addr": 662448}, "ZwQueryAuxiliaryCounterFrequency": {"args": [], "addr": 662576}, "ZwQueryBootOptions": {"args": ["_Out_writes_bytes_opt_(*BootOptionsLength) PBOOT_OPTIONS BootOptions", "_Inout_ PULONG BootOptionsLength"], "addr": 662640}, "ZwQueryDriverEntryOrder": {"args": ["_Out_writes_opt_(*Count) PULONG Ids", "_Inout_ PULONG Count"], "addr": 662768}, "ZwQueryFullAttributesFile": {"args": ["_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Out_ PFILE_NETWORK_OPEN_INFORMATION FileInformation"], "addr": 662832}, "ZwQueryInformationEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_ ENLISTMENT_INFORMATION_CLASS EnlistmentInformationClass", "_Out_writes_bytes_(EnlistmentInformationLength) PVOID EnlistmentInformation", "_In_ ULONG EnlistmentInformationLength", "_Out_ PULONG ReturnLength"], "addr": 662960}, "ZwQueryOpenSubKeys": {"args": ["_In_ POBJECT_ATTRIBUTES TargetKey", "_Out_ PULONG HandleCount"], "addr": 663408}, "ZwQueryQuotaInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID Buffer", "_In_ ULONG Length", "_In_ BOOLEAN ReturnSingleEntry", "_In_reads_bytes_opt_(SidListLength) PVOID SidList", "_In_ ULONG SidListLength", "_In_reads_bytes_opt_((8 + (4 * ((SID *)StartSid)->SubAuthorityCount))) // SeLengthSid()\n    PSID StartSid", "_In_ BOOLEAN RestartScan"], "addr": 663504}, "ZwQuerySecurityPolicy": {"args": [], "addr": 663600}, "ZwRaiseException": {"args": ["_In_ PEXCEPTION_RECORD ExceptionRecord", "_In_ PCONTEXT ContextRecord", "_In_ BOOLEAN FirstChance"], "addr": 663952}, "ZwReadVirtualMemoryEx": {"args": [], "addr": 664048}, "ZwRecoverTransactionManager": {"args": ["_In_ HANDLE TransactionManagerHandle"], "addr": 664144}, "ZwRegisterThreadTerminatePort": {"args": ["_In_ HANDLE PortHandle"], "addr": 664208}, "ZwReplyWaitReplyPort": {"args": ["_In_ HANDLE PortHandle", "_Inout_ PPORT_MESSAGE ReplyMessage"], "addr": 664496}, "ZwSaveKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ HANDLE FileHandle"], "addr": 664880}, "ZwSaveKeyEx": {"args": ["_In_ HANDLE KeyHandle", "_In_ HANDLE FileHandle", "_In_ ULONG Format"], "addr": 664912}, "ZwSetIRTimer": {"args": ["_In_ HANDLE TimerHandle", "_In_opt_ PLARGE_INTEGER DueTime"], "addr": 665456}, "ZwSetInformationIoRing": {"args": [], "addr": 665584}, "ZwSetInformationJobObject": {"args": ["_In_ HANDLE JobHandle", "_In_ JOBOBJECTINFOCLASS JobObjectInformationClass", "_In_reads_bytes_(JobObjectInformationLength) PVOID JobObjectInformation", "_In_ ULONG JobObjectInformationLength"], "addr": 665616}, "ZwSetInformationTransactionManager": {"args": ["_In_opt_ HANDLE TmHandle", "_In_ TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass", "_In_reads_bytes_(TransactionManagerInformationLength) PVOID TransactionManagerInformation", "_In_ ULONG TransactionManagerInformationLength"], "addr": 665808}, "ZwSetIoCompletion": {"args": ["_In_ HANDLE IoCompletionHandle", "_In_opt_ PVOID KeyContext", "_In_opt_ PVOID ApcContext", "_In_ NTSTATUS IoStatus", "_In_ ULONG_PTR IoStatusInformation"], "addr": 665936}, "ZwSetQuotaInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_reads_bytes_(Length) PVOID Buffer", "_In_ ULONG Length"], "addr": 666096}, "ZwSetTimer2": {"args": ["_In_ HANDLE TimerHandle", "_In_ PLARGE_INTEGER DueTime", "_In_opt_ PLARGE_INTEGER Period", "_In_ PT2_SET_PARAMETERS Parameters"], "addr": 666352}, "ZwStartProfile": {"args": ["_In_ HANDLE ProfileHandle"], "addr": 666672}, "ZwThawRegistry": {"args": [], "addr": 666992}, "ZwUnloadKey": {"args": ["_In_ POBJECT_ATTRIBUTES TargetKey"], "addr": 667184}, "ZwWaitForDebugEvent": {"args": [], "addr": 667504}}, "win32u.dll": {"NtGdiDeleteObjectApp": {"args": ["_In_ HANDLE hobj"], "addr": 6304}, "NtGdiCreateCompatibleDC": {"args": ["_In_opt_ HDC hdc"], "addr": 7808}, "NtGdiHfontCreate": {"args": ["_In_reads_bytes_(cjElfw) ENUMLOGFONTEXDVW *pelfw", "_In_ ULONG cjElfw", "_In_ LFTYPE lft", "_In_ FLONG fl", "_In_ PVOID pvCliData"], "addr": 8064}, "NtGdiGetAndSetDCDword": {"args": ["_In_ HDC hdc", "_In_ UINT u", "_In_ DWORD dwIn", "_Out_ DWORD *pdwResult"], "addr": 8384}, "NtUserGetThreadDesktop": {"args": [], "addr": 9216}, "NtGdiExtCreateRegion": {"args": ["_In_opt_ LPXFORM px", "_In_ DWORD cj", "_In_reads_bytes_(cj) LPRGNDATA prgn"], "addr": 9440}, "NtGdiRectangle": {"args": ["_In_ HDC hdc", "_In_ int xLeft", "_In_ int yTop", "_In_ int xRight", "_In_ int yBottom"], "addr": 9632}, "NtUserRegisterClassExWOW": {"args": [], "addr": 10464}, "NtGdiCreatePatternBrushInternal": {"args": ["_In_ HBITMAP hbm", "_In_ BOOL bPen", "_In_ BOOL b8X8"], "addr": 10496}, "NtUserCloseWindowStation": {"args": [], "addr": 10624}, "NtUserSetClassLong": {"args": [], "addr": 10976}, "NtGdiGetNearestPaletteIndex": {"args": ["_In_ HPALETTE hpal", "_In_ COLORREF crColor"], "addr": 11040}, "NtUserValidateRect": {"args": [], "addr": 11264}, "NtUserSetThreadState": {"args": [], "addr": 11616}, "NtUserRealInternalGetMessage": {"args": [], "addr": 12160}, "NtUserCreateLocalMemHandle": {"args": [], "addr": 12192}, "NtUserEnumDisplaySettings": {"args": [], "addr": 13472}, "NtGdiSetBitmapDimension": {"args": ["_In_ HBITMAP hbm", "_In_ int cx", "_In_ int cy", "_Out_opt_ LPSIZE psizeOut"], "addr": 13568}, "NtDCompositionConfirmFrame": {"args": [], "addr": 14272}, "NtDCompositionSetChildRootVisual": {"args": [], "addr": 15392}, "NtDCompositionSetMaterialProperty": {"args": [], "addr": 15456}, "NtDxgkPinResources": {"args": [], "addr": 16416}, "NtDxgkVailDisconnect": {"args": [], "addr": 16704}, "NtFlipObjectQueryEndpointConnected": {"args": [], "addr": 17248}, "NtGdiCreateBitmapFromDxSurface": {"args": ["_In_ HDC hdc", "_In_ UINT uiWidth", "_In_ UINT uiHeight", "_In_ DWORD Format", "_In_opt_ HANDLE hDxSharedSurface"], "addr": 18336}, "NtGdiCreateMetafileDC": {"args": ["_In_ HDC hdc"], "addr": 18496}, "NtGdiDDCCIGetCapabilitiesString": {"args": [], "addr": 18688}, "NtGdiDdCreateFullscreenSprite": {"args": ["_In_ HDC hdc", "_In_ COLORREF crKey", "_Out_ HANDLE* phSprite", "_Out_ HDC* phdcSprite"], "addr": 18880}, "NtGdiDdDDIConfigureSharedResource": {"args": [], "addr": 19456}, "NtGdiDdDDIDestroyHwQueue": {"args": [], "addr": 20224}, "NtGdiDdDDIGetProcessSchedulingPriorityClass": {"args": [], "addr": 21312}, "NtGdiDdDDIGetResourcePresentPrivateDriverData": {"args": [], "addr": 21344}, "NtGdiDdDDIOpenResource": {"args": [], "addr": 22336}, "NtGdiDdDDIOpenSyncObjectNtHandleFromName": {"args": [], "addr": 22496}, "NtGdiDdDDIPresentMultiPlaneOverlay2": {"args": [], "addr": 22816}, "NtGdiDdDDIQueryProtectedSessionStatus": {"args": [], "addr": 23104}, "NtGdiDdDDIRender": {"args": [], "addr": 23552}, "NtGdiDdDDISetVidPnSourceOwner": {"args": [], "addr": 24192}, "NtGdiDdDDIShareObjects": {"args": [], "addr": 24256}, "NtGdiEngCheckAbort": {"args": ["_In_ SURFOBJ *pso"], "addr": 25600}, "NtGdiEngDeletePath": {"args": ["_In_ PATHOBJ *ppo"], "addr": 25920}, "NtGdiEngStrokeAndFillPath": {"args": ["_In_ SURFOBJ *pso", "_In_ PATHOBJ *ppo", "_In_ CLIPOBJ *pco", "_In_ XFORMOBJ *pxo", "_In_ BRUSHOBJ *pboStroke", "_In_ LINEATTRS *plineattrs", "_In_ BRUSHOBJ *pboFill", "_In_ POINTL *pptlBrushOrg", "_In_ MIX mix", "_In_ FLONG flOptions"], "addr": 26304}, "NtGdiFrameRgn": {"args": ["_In_ HDC hdc", "_In_ HRGN hrgn", "_In_ HBRUSH hbrush", "_In_ int xWidth", "_In_ int yHeight"], "addr": 26976}, "NtGdiGetDCDpiScaleValue": {"args": ["_In_ HDC hdc"], "addr": 27424}, "NtGdiGetServerMetaFileBits": {"args": ["_In_ HANDLE hmo", "_In_ ULONG cjData", "_Out_writes_bytes_opt_(cjData) LPBYTE pjData", "_Out_ PDWORD piType", "_Out_ PDWORD pmm", "_Out_ PDWORD pxExt", "_Out_ PDWORD pyExt"], "addr": 28448}, "NtGdiMonoBitmap": {"args": ["_In_ HBITMAP hbm"], "addr": 29120}, "NtGdiOffsetClipRgn": {"args": ["_In_ HDC hdc", "_In_ int x", "_In_ int y"], "addr": 29184}, "NtGdiUpdateColors": {"args": ["_In_ HDC hdc"], "addr": 30944}, "NtMITActivateInputProcessing": {"args": [], "addr": 31456}, "NtMITMinuserSetInputTransformOffset": {"args": [], "addr": 31744}, "NtMITSetKeyboardInputRoutingPolicy": {"args": [], "addr": 32096}, "NtMITUpdateInputGlobals": {"args": [], "addr": 32320}, "NtModerncoreGetNavigationWindowVisual": {"args": [], "addr": 32736}, "NtRIMGetDeviceProperties": {"args": [], "addr": 33728}, "NtRIMUnregisterForInput": {"args": [], "addr": 34208}, "NtSetCompositionSurfaceDirectFlipState": {"args": [], "addr": 34336}, "NtUpdateInputSinkTransforms": {"args": [], "addr": 34816}, "NtUserBeginDeferWindowPos": {"args": [], "addr": 35136}, "NtUserChangeDisplaySettings": {"args": [], "addr": 35456}, "NtUserCompositionInputSinkLuidFromPoint": {"args": [], "addr": 35936}, "NtUserCreatePopupMenu": {"args": [], "addr": 36320}, "NtUserCreateSystemThreads": {"args": [], "addr": 36352}, "NtUserCreateWindowStation": {"args": [], "addr": 36384}, "NtUserDeferredDesktopRotation": {"args": [], "addr": 36576}, "NtUserDoSoundConnect": {"args": [], "addr": 37120}, "NtUserDownlevelTouchpad": {"args": [], "addr": 37216}, "NtUserEnableChildWindowDpiMessage": {"args": [], "addr": 37696}, "NtUserEnableMouseInPointer": {"args": [], "addr": 37792}, "NtUserEnableWindowResizeOptimization": {"args": [], "addr": 38176}, "NtUserForceEnableNumpadTranslation": {"args": [], "addr": 38368}, "NtUserGetPointerDeviceInputSpace": {"args": [], "addr": 40480}, "NtUserGetPointerType": {"args": [], "addr": 40768}, "NtUserGetWinStationInfo": {"args": [], "addr": 41696}, "NtUserHungWindowFromGhostWindow": {"args": [], "addr": 42304}, "NtUserHwndSetRedirectionInfo": {"args": [], "addr": 42368}, "NtUserInitializeClientPfnArrays": {"args": [], "addr": 42592}, "NtUserLogicalToPhysicalPoint": {"args": [], "addr": 43808}, "NtUserPaintMonitor": {"args": [], "addr": 44480}, "NtUserPostKeyboardInputMessage": {"args": [], "addr": 44640}, "NtUserPromoteMouseInPointer": {"args": [], "addr": 44800}, "NtUserRemoteReconnect": {"args": [], "addr": 46368}, "NtUserRemoteRedrawRectangle": {"args": [], "addr": 46400}, "NtUserReportInertia": {"args": [], "addr": 46816}, "NtUserResetDblClk": {"args": [], "addr": 46848}, "NtUserSetAutoRotation": {"args": [], "addr": 47200}, "NtUserSetProcessDefaultLayout": {"args": [], "addr": 48832}, "NtUserSetProcessInteractionFlags": {"args": [], "addr": 48896}, "NtUserSetProcessUIAccessZorder": {"args": [], "addr": 49024}, "NtUserSetSharedWindowData": {"args": [], "addr": 49088}, "NtUserSetShellChangeNotifyHWND": {"args": [], "addr": 49120}, "NtUserSetWaitForQueueAttach": {"args": [], "addr": 49568}, "NtUserSetWindowCompositionTransition": {"args": [], "addr": 49696}, "NtUserShutdownBlockReasonCreate": {"args": [], "addr": 50272}, "NtUserUpdateWindow": {"args": [], "addr": 51264}, "NtUserWakeRITForShutdown": {"args": [], "addr": 51616}}};
var funcs_map = {};
var register_args = ["rcx", "rdx", "r8", "r9"];

function lib_includes(libname, liblist) {
  for (var i = 0; i < liblist.length; i++) {
    if (libname.toLowerCase() == liblist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function func_includes(funcname, funclist) {
  for (var i = 0; i < funclist.length; i++) {
    if (funcname.toLowerCase() == funclist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function mutate_n(n, ratio){
  return n + Math.floor(Math.random() * ratio) - ratio/2;
}

function mutate_buf(ptr, size, arg_i) {
  let buf = Memory.readByteArray(ptr, size);
  let buf_view = new Uint8Array(buf);
  // deep copy buf
  let new_buf = new ArrayBuffer(size);
  let new_buf_view = new Uint8Array(new_buf);
  for (let i = 0; i < size; i++) {
      if (Math.random() < 0.9) {
        new_buf_view[i] = buf_view[i];
      }else{
        new_buf_view[i] = mutate_n(buf_view[i], 10)
        }
    }
  Memory.writeByteArray(ptr, new_buf_view);
  console.log("Mutating buffer arg " + arg_i);
  console.log("From:");
  console.log(buf);
  console.log("To:");
  console.log(new_buf);
}

function mutate_args(context, args, f_args_infos) {
  let syscall_args = ["rcx", "rdx", "r8", "r9"];
  for (let i = 0; i < args.length; i++) {
    if (Memory.readPointer(args[i]) != 0 && Math.random() < 0.4) {
       mutate_buf(Memory.readPointer(args[i]), 0x100, i);
    }
    else if (i < syscall_args.length && Math.random() < 0.15 ) {
        let reg_name = syscall_args[i];
        // convert to int
        let reg_val = parseInt(args[i]);
        let new_val = mutate_n(reg_val, 10000);
        context[reg_name] = new_val;
        let hex_val = "0x" + new_val.toString(16);
        console.log("Mutating " + reg_name + " from " + args[i] + " to " + hex_val);
    }
  }
}


setTimeout(function() {
  Process.enumerateModules({
    onMatch: function(module) {
      //console.log("Found " + module.name + " at " + module.base);
      if (lib_includes(module.name, Object.keys(sys_data))) {
        let exports = module.enumerateExports();
        let module_name = module.name.toLowerCase();
        for (let f_name in sys_data[module_name]) {
          // call random function
          
          let infos = sys_data[module_name][f_name];
          let ea = infos["addr"]
          ea = module.base.add(ptr(ea));
          funcs_map[ea] = [f_name, module.name]
          try {
            //console.log("Hooking " + f_name + " at " + ea);
            Interceptor.attach(ea, {
              onEnter: function(args) {
                let f_name = funcs_map[this.context.pc][0];
                let module_name = funcs_map[this.context.pc][1];
                console.log(f_name); 
                let rcx = this.context.rcx;
                let rdx = this.context.rdx;
                let r8 = this.context.r8;
                let r9 = this.context.r9;
                let syscall_args = [rcx, rdx, r8, r9];
                let arg_index = 0;
                let stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                while (stack_arg != 0 && arg_index < 4) {
                  stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                  syscall_args.push(stack_arg);
                  arg_index++;
                }
                let f_args_infos = sys_data[module_name][f_name]["args"];
                for (let i = 0; i < syscall_args.length; i++) {
                  let arg_info = "";
                  if (i < f_args_infos.length) {
                    arg_info = f_args_infos[i];
                  }
                  console.log("Arg " + i + ": " + " " + arg_info + " " + syscall_args[i]);
                }
                mutate_args(this.context, syscall_args, f_args_infos);
                
              }
            });
          } catch (e) {
            console.log("Error: " + e);
          }
        }
      }
    },
    onComplete: function() {
    }
  });
}, 500);
