
var sys_data = {"ntdll.dll": {"sub_9EF10": {"args": [], "addr": 651024}, "ZwAcceptConnectPort": {"args": ["_Out_ PHANDLE PortHandle", "_In_opt_ PVOID PortContext", "_In_ PPORT_MESSAGE ConnectionRequest", "_In_ BOOLEAN AcceptConnection", "_Inout_opt_ PPORT_VIEW ServerView", "_Out_opt_ PREMOTE_PORT_VIEW ClientView"], "addr": 652192}, "ZwMapUserPhysicalPagesScatter": {"args": ["_In_reads_(NumberOfPages) PVOID *VirtualAddresses", "_In_ ULONG_PTR NumberOfPages", "_In_reads_opt_(NumberOfPages) PULONG_PTR UserPfnArray"], "addr": 652224}, "ZwWaitForSingleObject": {"args": ["_In_ HANDLE Handle", "_In_ BOOLEAN Alertable", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 652256}, "ZwReadFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ PFILE_SEGMENT_ELEMENT SegmentArray", "_In_ ULONG Length", "_In_opt_ PLARGE_INTEGER ByteOffset", "_In_opt_ PULONG Key"], "addr": 652320}, "ZwSetInformationThread": {"args": ["_In_ HANDLE ThreadHandle", "_In_ THREADINFOCLASS ThreadInformationClass", "_In_reads_bytes_(ThreadInformationLength) PVOID ThreadInformation", "_In_ ULONG ThreadInformationLength"], "addr": 652544}, "ZwSetEvent": {"args": ["_In_ HANDLE EventHandle", "_Out_opt_ PLONG PreviousState"], "addr": 652576}, "ZwFindAtom": {"args": ["_In_reads_bytes_opt_(Length) PWSTR AtomName", "_In_ ULONG Length", "_Out_opt_ PRTL_ATOM Atom"], "addr": 652768}, "ZwQueryKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_INFORMATION_CLASS KeyInformationClass", "_Out_writes_bytes_opt_(Length) PVOID KeyInformation", "_In_ ULONG Length", "_Out_ PULONG ResultLength"], "addr": 652832}, "ZwQueryInformationProcess": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PROCESSINFOCLASS ProcessInformationClass", "_Out_writes_bytes_opt_(ProcessInformationLength) PVOID ProcessInformation", "_In_ ULONG ProcessInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 652928}, "ZwReleaseMutant": {"args": ["_In_ HANDLE MutantHandle", "_Out_opt_ PLONG PreviousCount"], "addr": 653152}, "ZwReadFileScatter": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ PFILE_SEGMENT_ELEMENT SegmentArray", "_In_ ULONG Length", "_In_opt_ PLARGE_INTEGER ByteOffset", "_In_opt_ PULONG Key"], "addr": 653600}, "ZwQueryPerformanceCounter": {"args": ["_Out_ PLARGE_INTEGER PerformanceCounter", "_Out_opt_ PLARGE_INTEGER PerformanceFrequency"], "addr": 653696}, "ZwEnumerateKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ ULONG Index", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_INFORMATION_CLASS KeyInformationClass", "_Out_writes_bytes_opt_(Length) PVOID KeyInformation", "_In_ ULONG Length", "_Out_ PULONG ResultLength"], "addr": 653728}, "ZwQuerySystemInformation": {"args": ["_In_ SYSTEM_INFORMATION_CLASS SystemInformationClass", "_Out_writes_bytes_to_opt_(SystemInformationLength,*ReturnLength) PVOID SystemInformation", "_In_ ULONG SystemInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 653856}, "ZwFsControlFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ ULONG FsControlCode", "_In_reads_bytes_opt_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(OutputBufferLength) PVOID OutputBuffer", "_In_ ULONG OutputBufferLength"], "addr": 653952}, "ZwContinue": {"args": ["_In_ PCONTEXT ContextRecord", "_In_ BOOLEAN TestAlert"], "addr": 654272}, "ZwQueueApcThread": {"args": ["_In_ HANDLE ThreadHandle", "_In_ PPS_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcArgument1", "_In_opt_ PVOID ApcArgument2", "_In_opt_ PVOID ApcArgument3"], "addr": 654336}, "ZwYieldExecution": {"args": ["VOID"], "addr": 654368}, "ZwApphelpCacheControl": {"args": [], "addr": 654560}, "ZwCreateProcessEx": {"args": ["_Out_ PHANDLE ProcessHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ HANDLE ParentProcess", "_In_ ULONG Flags", "_In_opt_ HANDLE SectionHandle", "_In_opt_ HANDLE DebugPort", "_In_opt_ HANDLE TokenHandle", "_In_ ULONG JobMemberLevel"], "addr": 654592}, "ZwCreateThread": {"args": ["_Out_ PHANDLE ThreadHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ HANDLE ProcessHandle", "_Out_ PCLIENT_ID ClientId", "_In_ PCONTEXT ThreadContext", "_In_ PINITIAL_TEB InitialTeb", "_In_ BOOLEAN CreateSuspended"], "addr": 654624}, "ZwProtectVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_Inout_ PVOID *BaseAddress", "_Inout_ PSIZE_T RegionSize", "_In_ ULONG NewProtect", "_Out_ PULONG OldProtect"], "addr": 654688}, "ZwQueryEvent": {"args": ["_In_ HANDLE EventHandle", "_In_ EVENT_INFORMATION_CLASS EventInformationClass", "_Out_writes_bytes_(EventInformationLength) PVOID EventInformation", "_In_ ULONG EventInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 654880}, "ZwAccessCheckByTypeAndAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ ACCESS_MASK DesiredAccess", "_In_ AUDIT_EVENT_TYPE AuditType", "_In_ ULONG Flags", "_In_reads_opt_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_ PACCESS_MASK GrantedAccess", "_Out_ PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 654976}, "ZwPowerInformation": {"args": ["_In_ POWER_INFORMATION_LEVEL InformationLevel", "_In_reads_bytes_opt_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(OutputBufferLength) PVOID OutputBuffer", "_In_ ULONG OutputBufferLength"], "addr": 655152}, "ZwAccessCheckByType": {"args": ["_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ HANDLE ClientToken", "_In_ ACCESS_MASK DesiredAccess", "_In_reads_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_Out_writes_bytes_(*PrivilegeSetLength) PPRIVILEGE_SET PrivilegeSet", "_Inout_ PULONG PrivilegeSetLength", "_Out_ PACCESS_MASK GrantedAccess", "_Out_ PNTSTATUS AccessStatus"], "addr": 655280}, "ZwAccessCheckByTypeResultListAndAuditAlarmByHandle": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ HANDLE ClientToken", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ ACCESS_MASK DesiredAccess", "_In_ AUDIT_EVENT_TYPE AuditType", "_In_ ULONG Flags", "_In_reads_opt_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_writes_(ObjectTypeListLength) PACCESS_MASK GrantedAccess", "_Out_writes_(ObjectTypeListLength) PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 655376}, "ZwAlertThread": {"args": ["_In_ HANDLE ThreadHandle"], "addr": 655664}, "ZwAlpcCreatePort": {"args": ["_Out_ PHANDLE PortHandle", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PALPC_PORT_ATTRIBUTES PortAttributes"], "addr": 656048}, "ZwAlpcCreateSectionView": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_Inout_ PALPC_DATA_VIEW_ATTR ViewAttributes"], "addr": 656144}, "ZwAlpcImpersonateClientOfPort": {"args": ["_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE Message", "_In_ PVOID Flags"], "addr": 656400}, "ZwAlpcOpenSenderProcess": {"args": ["_Out_ PHANDLE ProcessHandle", "_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE PortMessage", "_In_ ULONG Flags", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 656432}, "ZwAlpcQueryInformationMessage": {"args": ["_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE PortMessage", "_In_ __drv_strictTypeMatch(__drv_typeConst) ALPC_MESSAGE_INFORMATION_CLASS MessageInformationClass", "_Out_writes_bytes_to_opt_(Length,*ReturnLength) PVOID MessageInformation", "_In_ ULONG Length", "_Out_opt_ PULONG ReturnLength"], "addr": 656528}, "ZwChangeThreadState": {"args": [], "addr": 656944}, "ZwCompressKey": {"args": ["_In_ HANDLE Key"], "addr": 657264}, "ZwConnectPort": {"args": ["_Out_ PHANDLE PortHandle", "_In_ PUNICODE_STRING PortName", "_In_ PSECURITY_QUALITY_OF_SERVICE SecurityQos", "_Inout_opt_ PPORT_VIEW ClientView", "_Inout_opt_ PREMOTE_PORT_VIEW ServerView", "_Out_opt_ PULONG MaxMessageLength", "_Inout_updates_bytes_to_opt_(*ConnectionInformationLength,*ConnectionInformationLength)", "PVOID ConnectionInformation", "_Inout_opt_ PULONG ConnectionInformationLength"], "addr": 657296}, "ZwCreateCpuPartition": {"args": [], "addr": 657424}, "ZwCreateCrossVmEvent": {"args": [], "addr": 657456}, "ZwCreateDirectoryObject": {"args": ["_Out_ PHANDLE DirectoryHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 657552}, "ZwCreateEventPair": {"args": ["_Out_ PHANDLE EventPairHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 657680}, "ZwCreateIoCompletion": {"args": ["_Out_ PHANDLE IoCompletionHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ ULONG Count"], "addr": 657744}, "ZwCreateKeyTransacted": {"args": ["_Out_ PHANDLE KeyHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Reserved_ ULONG TitleIndex", "_In_opt_ PUNICODE_STRING Class", "_In_ ULONG CreateOptions", "_In_ HANDLE TransactionHandle", "_Out_opt_ PULONG Disposition"], "addr": 657872}, "ZwCreatePagingFile": {"args": ["_In_ PUNICODE_STRING PageFileName", "_In_ PLARGE_INTEGER MinimumSize", "_In_ PLARGE_INTEGER MaximumSize", "_In_ ULONG Flags"], "addr": 658064}, "ZwCreatePrivateNamespace": {"args": ["_Out_ PHANDLE NamespaceHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ PVOID BoundaryDescriptor"], "addr": 658160}, "ZwCreateSymbolicLinkObject": {"args": ["_Out_ PHANDLE LinkHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ PUNICODE_STRING LinkTarget"], "addr": 658448}, "ZwCreateThreadStateChange": {"args": [], "addr": 658512}, "ZwCreateTimer2": {"args": ["_Out_ PHANDLE TimerHandle", "_In_opt_ PVOID Reserved1", "_In_opt_ PVOID Reserved2", "_In_ ULONG Attributes", "_In_ ACCESS_MASK DesiredAccess"], "addr": 658576}, "ZwDeleteBootEntry": {"args": ["_In_ ULONG Id"], "addr": 658992}, "ZwDeleteObjectAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ BOOLEAN GenerateOnClose"], "addr": 659120}, "ZwDisableLastKnownGood": {"args": ["VOID"], "addr": 659312}, "ZwExtendSection": {"args": ["_In_ HANDLE SectionHandle", "_Inout_ PLARGE_INTEGER NewSectionSize"], "addr": 659568}, "ZwFlushKey": {"args": ["_In_ HANDLE KeyHandle"], "addr": 659792}, "ZwFlushVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_Inout_ PVOID *BaseAddress", "_Inout_ PSIZE_T RegionSize", "_Out_ PIO_STATUS_BLOCK IoStatus"], "addr": 659856}, "ZwGetContextThread": {"args": ["_In_ HANDLE ThreadHandle", "_Inout_ PCONTEXT ThreadContext"], "addr": 660080}, "ZwGetCurrentProcessorNumberEx": {"args": ["_Out_ PPROCESSOR_NUMBER ProcNumber"], "addr": 660144}, "ZwMakePermanentObject": {"args": ["_In_ HANDLE Handle"], "addr": 661008}, "ZwMapCMFModule": {"args": ["_In_ ULONG What", "_In_ ULONG Index", "_Out_opt_ ULONG *CacheIndexOut", "_Out_opt_ ULONG *CacheFlagsOut", "_Out_opt_ ULONG *ViewSizeOut", "_Out_opt_ PVOID *BaseAddress"], "addr": 661136}, "ZwOpenEventPair": {"args": ["_Out_ PHANDLE EventPairHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661520}, "ZwOpenObjectAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_opt_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_ HANDLE ClientToken", "_In_ ACCESS_MASK DesiredAccess", "_In_ ACCESS_MASK GrantedAccess", "_In_opt_ PPRIVILEGE_SET Privileges", "_In_ BOOLEAN ObjectCreation", "_In_ BOOLEAN AccessGranted", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 661776}, "ZwOpenPartition": {"args": ["_Out_ PHANDLE PartitionHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661808}, "ZwOpenThread": {"args": ["_Out_ PHANDLE ThreadHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PCLIENT_ID ClientId"], "addr": 662064}, "ZwOpenTimer": {"args": ["_Out_ PHANDLE TimerHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 662096}, "ZwPrePrepareEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 662256}, "ZwPrivilegeCheck": {"args": ["_In_ HANDLE ClientToken", "_Inout_ PPRIVILEGE_SET RequiredPrivileges", "_Out_ PBOOLEAN Result"], "addr": 662352}, "ZwPssCaptureVaSpaceBulk": {"args": [], "addr": 662512}, "ZwQueryAuxiliaryCounterFrequency": {"args": [], "addr": 662576}, "ZwQueryBootEntryOrder": {"args": ["_Out_writes_opt_(*Count) PULONG Ids", "_Inout_ PULONG Count"], "addr": 662608}, "ZwQueryDriverEntryOrder": {"args": ["_Out_writes_opt_(*Count) PULONG Ids", "_Inout_ PULONG Count"], "addr": 662768}, "ZwQueryInformationAtom": {"args": ["_In_ RTL_ATOM Atom", "_In_ ATOM_INFORMATION_CLASS AtomInformationClass", "_Out_writes_bytes_(AtomInformationLength) PVOID AtomInformation", "_In_ ULONG AtomInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 662864}, "ZwQueryInformationTransaction": {"args": ["_In_ HANDLE TransactionManagerHandle", "_In_ TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass", "_Out_writes_bytes_(TransactionManagerInformationLength) PVOID TransactionManagerInformation", "_In_ ULONG TransactionManagerInformationLength", "_Out_ PULONG ReturnLength"], "addr": 663088}, "ZwQueryIoCompletion": {"args": ["_In_ HANDLE IoCompletionHandle", "_In_ IO_COMPLETION_INFORMATION_CLASS IoCompletionInformationClass", "_Out_writes_bytes_(IoCompletionInformationLength) PVOID IoCompletionInformation", "_In_ ULONG IoCompletionInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 663248}, "ZwQueryLicenseValue": {"args": ["_In_ PUNICODE_STRING ValueName", "_Out_opt_ PULONG Type", "_Out_writes_bytes_to_opt_(DataSize,*ResultDataSize) PVOID Data", "_In_ ULONG DataSize", "_Out_ PULONG ResultDataSize"], "addr": 663312}, "ZwQueryQuotaInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID Buffer", "_In_ ULONG Length", "_In_ BOOLEAN ReturnSingleEntry", "_In_reads_bytes_opt_(SidListLength) PVOID SidList", "_In_ ULONG SidListLength", "_In_reads_bytes_opt_((8 + (4 * ((SID *)StartSid)->SubAuthorityCount))) // SeLengthSid()\n    PSID StartSid", "_In_ BOOLEAN RestartScan"], "addr": 663504}, "ZwQuerySecurityPolicy": {"args": [], "addr": 663600}, "ZwQueryTimerResolution": {"args": ["_Out_ PULONG MaximumTime", "_Out_ PULONG MinimumTime", "_Out_ PULONG CurrentTime"], "addr": 663792}, "ZwQueryWnfStateData": {"args": ["_In_ PCWNF_STATE_NAME StateName", "_In_opt_ PCWNF_TYPE_ID TypeId", "_In_opt_ const VOID* ExplicitScope", "_Out_ PWNF_CHANGE_STAMP ChangeStamp", "_Out_writes_bytes_to_opt_(*BufferSize,*BufferSize) PVOID Buffer", "_Inout_ PULONG BufferSize"], "addr": 663824}, "ZwRaiseException": {"args": ["_In_ PEXCEPTION_RECORD ExceptionRecord", "_In_ PCONTEXT ContextRecord", "_In_ BOOLEAN FirstChance"], "addr": 663952}, "ZwRecoverEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PVOID EnlistmentKey"], "addr": 664080}, "ZwReleaseKeyedEvent": {"args": ["_In_ HANDLE KeyedEventHandle", "_In_ PVOID KeyValue", "_In_ BOOLEAN Alertable", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 664240}, "ZwRenameKey": {"args": ["_In_ HANDLE      KeyHandle", "_In_ PUNICODE_STRING NewName"], "addr": 664368}, "ZwReplyWaitReplyPort": {"args": ["_In_ HANDLE PortHandle", "_Inout_ PPORT_MESSAGE ReplyMessage"], "addr": 664496}, "ZwResetWriteWatch": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PVOID BaseAddress", "_In_ SIZE_T RegionSize"], "addr": 664592}, "ZwRevertContainerImpersonation": {"args": ["VOID"], "addr": 664688}, "ZwRollbackTransaction": {"args": ["_In_ HANDLE TransactionHandle", "_In_ BOOLEAN Wait"], "addr": 664816}, "ZwSetBootEntryOrder": {"args": ["_In_reads_(Count) PULONG Ids", "_In_ ULONG Count"], "addr": 665040}, "ZwSetBootOptions": {"args": ["_In_ PBOOT_OPTIONS BootOptions", "_In_ ULONG FieldsToChange"], "addr": 665072}, "ZwSetInformationSymbolicLink": {"args": ["__in HANDLE LinkHandle", "__in SYMBOLIC_LINK_INFO_CLASS SymbolicLinkClass", "__in_bcount_opt(SymbolicLinkInformationLength) PVOID SymbolicLinkInformation", "__in ULONG SymbolicLinkInformationLength"], "addr": 665712}, "ZwSetInformationTransaction": {"args": ["_In_opt_ HANDLE TmHandle", "_In_ TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass", "_In_reads_bytes_(TransactionManagerInformationLength) PVOID TransactionManagerInformation", "_In_ ULONG TransactionManagerInformationLength"], "addr": 665776}, "ZwSetInformationTransactionManager": {"args": ["_In_opt_ HANDLE TmHandle", "_In_ TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass", "_In_reads_bytes_(TransactionManagerInformationLength) PVOID TransactionManagerInformation", "_In_ ULONG TransactionManagerInformationLength"], "addr": 665808}, "ZwSetSecurityObject": {"args": ["_In_ HANDLE Handle", "_In_ SECURITY_INFORMATION SecurityInformation", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor"], "addr": 666128}, "ZwSetSystemEnvironmentValueEx": {"args": ["_In_ PUNICODE_STRING VariableName", "_In_ LPGUID VendorGuid", "_In_reads_bytes_opt_(ValueLength) PVOID Value", "_In_ ULONG ValueLength", "_In_ ULONG Attributes"], "addr": 666192}, "ZwSetThreadExecutionState": {"args": ["_In_ EXECUTION_STATE NewFlags,       // ES_xxx flags\n  _Out_ PEXECUTION_STATE PreviousFlags"], "addr": 666320}, "ZwSetTimer2": {"args": ["_In_ HANDLE TimerHandle", "_In_ PLARGE_INTEGER DueTime", "_In_opt_ PLARGE_INTEGER Period", "_In_ PT2_SET_PARAMETERS Parameters"], "addr": 666352}, "ZwShutdownWorkerFactory": {"args": [], "addr": 666576}, "ZwSuspendProcess": {"args": ["_In_ HANDLE ProcessHandle"], "addr": 666800}, "ZwThawTransactions": {"args": ["void"], "addr": 667024}, "ZwTranslateFilePath": {"args": ["_In_ PFILE_PATH InputFilePath", "_In_ ULONG OutputType", "_Out_writes_bytes_opt_(*OutputFilePathLength) PFILE_PATH OutputFilePath", "_Inout_opt_ PULONG OutputFilePathLength"], "addr": 667088}, "ZwUmsThreadYield": {"args": ["_In_ PVOID SchedulerParam"], "addr": 667120}, "ZwUnloadDriver": {"args": ["_In_ PUNICODE_STRING DriverServiceName"], "addr": 667152}, "ZwUnlockVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_Inout_ PVOID *BaseAddress", "_Inout_ PSIZE_T RegionSize", "_In_ ULONG MapType"], "addr": 667312}, "ZwWaitForAlertByThreadId": {"args": [], "addr": 667472}}, "win32u.dll": {"NtGdiSelectBitmap": {"args": ["_In_ HDC hdc", "_In_ HBITMAP hbm"], "addr": 5568}, "NtGdiDeleteObjectApp": {"args": ["_In_ HANDLE hobj"], "addr": 6304}, "NtGdiSetDIBitsToDeviceInternal": {"args": ["_In_ HDC hdcDest", "_In_ int xDst", "_In_ int yDst", "_In_ DWORD cx", "_In_ DWORD cy", "_In_ int xSrc", "_In_ int ySrc", "_In_ DWORD iStartScan", "_In_ DWORD cNumScan", "_In_reads_bytes_(cjMaxBits) LPBYTE pInitBits", "_In_ LPBITMAPINFO pbmi", "_In_ DWORD iUsage", "_In_ UINT cjMaxBits", "_In_ UINT cjMaxInfo", "_In_ BOOL bTransformCoordinates", "_In_opt_ HANDLE hcmXform"], "addr": 6464}, "NtGdiGetDCObject": {"args": ["_In_ HDC hdc", "_In_ int itype"], "addr": 6816}, "NtGdiLineTo": {"args": ["_In_ HDC hdc", "_In_ int x", "_In_ int y"], "addr": 7200}, "NtUserSystemParametersInfo": {"args": [], "addr": 7232}, "NtGdiExtGetObjectW": {"args": ["_In_ HANDLE h", "_In_ int cj", "_Out_writes_bytes_opt_(cj) LPVOID pvOut"], "addr": 7744}, "NtUserGetClipboardSequenceNumber": {"args": [], "addr": 7840}, "NtUserScrollDC": {"args": [], "addr": 8480}, "NtGdiDeleteClientObj": {"args": ["_In_ HANDLE h"], "addr": 9344}, "NtGdiExtCreateRegion": {"args": ["_In_opt_ LPXFORM px", "_In_ DWORD cj", "_In_reads_bytes_(cj) LPRGNDATA prgn"], "addr": 9440}, "NtUserCloseDesktop": {"args": [], "addr": 10176}, "NtGdiSetBrushOrg": {"args": ["_In_ HDC hdc", "_In_ int x", "_In_ int y", "_Out_ LPPOINT pptOut"], "addr": 10368}, "NtGdiCreatePatternBrushInternal": {"args": ["_In_ HBITMAP hbm", "_In_ BOOL bPen", "_In_ BOOL b8X8"], "addr": 10496}, "NtUserUnregisterClass": {"args": [], "addr": 10816}, "NtGdiGetPixel": {"args": ["_In_ HDC hdc", "_In_ int x", "_In_ int y"], "addr": 10944}, "NtUserSetClipboardData": {"args": [], "addr": 11360}, "NtUserSetThreadState": {"args": [], "addr": 11616}, "NtGdiOpenDCW": {"args": ["_In_opt_ PUNICODE_STRING pustrDevice", "_In_ DEVMODEW *pdm", "_In_ PUNICODE_STRING pustrLogAddr", "_In_ ULONG iType", "_In_ BOOL bDisplay", "_In_ BOOL bSkipRedirection", "_In_opt_ HANDLE hspool", "_In_opt_ DRIVER_INFO_2W *pDriverInfo2", "_At_((PUMDHPDEV *)pUMdhpdev,_Out_) VOID *pUMdhpdev"], "addr": 11648}, "NtGdiGetBitmapBits": {"args": ["_In_ HBITMAP hbm", "_In_ ULONG cjMax", "_Out_writes_bytes_opt_(cjMax) PBYTE pjOut"], "addr": 11776}, "NtGdiSetVirtualResolution": {"args": ["_In_ HDC hdc", "_In_ int cxVirtualDevicePixel", "_In_ int cyVirtualDevicePixel", "_In_ int cxVirtualDeviceMm", "_In_ int cyVirtualDeviceMm"], "addr": 12032}, "NtUserSetMenuDefaultItem": {"args": [], "addr": 12928}, "NtGdiGetSystemPaletteUse": {"args": ["_In_ HDC hdc"], "addr": 13408}, "NtDCompositionEnableMMCSS": {"args": [], "addr": 14656}, "NtDCompositionSetChannelConnectionId": {"args": [], "addr": 15360}, "NtDxgkConnectDoorbell": {"args": [], "addr": 15840}, "NtFlipObjectConsumerEndProcessPresent": {"args": [], "addr": 16960}, "NtGdiAbortDoc": {"args": ["_In_ HDC hdc"], "addr": 17472}, "NtGdiAddEmbFontToDC": {"args": ["_In_ HDC hdc", "_In_ VOID **pFontID"], "addr": 17536}, "NtGdiCancelDC": {"args": ["_In_ HDC hdc"], "addr": 18080}, "NtGdiCreateRoundRectRgn": {"args": ["_In_ int xLeft", "_In_ int yTop", "_In_ int xRight", "_In_ int yBottom", "_In_ int xWidth", "_In_ int yHeight"], "addr": 18592}, "NtGdiDdDDIAddSurfaceToSwapChain": {"args": [], "addr": 19040}, "NtGdiDdDDICreateProtectedSession": {"args": [], "addr": 19904}, "NtGdiDdDDICreateSynchronizationObject": {"args": [], "addr": 19968}, "NtGdiDdDDIDispMgrTargetOperation": {"args": [], "addr": 20512}, "NtGdiDdDDIEnumAdapters": {"args": [], "addr": 20544}, "NtGdiDdDDILock2": {"args": [], "addr": 21728}, "NtGdiDdDDINetDispGetNextChunkInfo": {"args": [], "addr": 21856}, "NtGdiDdDDIQueryProcessOfferInfo": {"args": [], "addr": 23040}, "NtGdiDdDDIReleaseKeyedMutex2": {"args": [], "addr": 23424}, "NtGdiDdDDISetStereoEnabled": {"args": [], "addr": 24096}, "NtGdiDdDDISetSyncRefreshCountWaitTarget": {"args": [], "addr": 24128}, "NtGdiDdDDISubmitSignalSyncObjectsToHwQueue": {"args": [], "addr": 24544}, "NtGdiDdDDIUpdateOverlay": {"args": [], "addr": 24800}, "NtGdiEllipse": {"args": ["_In_ HDC hdc", "_In_ int xLeft", "_In_ int yTop", "_In_ int xRight", "_In_ int yBottom"], "addr": 25344}, "NtGdiEngCreateDeviceBitmap": {"args": ["_In_ DHSURF dhsurf", "_In_ SIZEL sizl", "_In_ ULONG iFormatCompat"], "addr": 25760}, "NtGdiEngTextOut": {"args": ["_In_ SURFOBJ *pso", "_In_ STROBJ *pstro", "_In_ FONTOBJ *pfo", "_In_ CLIPOBJ *pco", "_In_ RECTL *prclExtra", "_In_ RECTL *prclOpaque", "_In_ BRUSHOBJ *pboFore", "_In_ BRUSHOBJ *pboOpaque", "_In_ POINTL *pptlOrg", "_In_ MIX mix"], "addr": 26368}, "NtGdiGetCOPPCompatibleOPMInformation": {"args": [], "addr": 27104}, "NtGdiGetCharABCWidthsW": {"args": ["_In_ HDC hdc", "_In_ UINT wchFirst", "_In_ ULONG cwch", "_In_reads_opt_(cwch) PWCHAR pwch", "_In_ FLONG fl", "_At_((ABC *)pvBuf,_Out_writes_bytes_(cwch * sizeof(ABC))) PVOID pvBuf"], "addr": 27264}, "NtGdiGetETM": {"args": ["_In_ HDC hdc", "_Out_opt_ EXTTEXTMETRIC *petm"], "addr": 27584}, "NtGdiGetRealizationInfo": {"args": ["_In_ HDC hdc", "_Out_ PFONT_REALIZATION_INFO2 pri"], "addr": 28416}, "NtGdiGetSpoolMessage": {"args": [], "addr": 28480}, "NtGdiScaleWindowExtEx": {"args": ["_In_ HDC hdc", "_In_ int xNum", "_In_ int xDenom", "_In_ int yNum", "_In_ int yDenom", "_Out_opt_ LPSIZE pszOut"], "addr": 30016}, "NtGdiSetLinkedUFIs": {"args": ["_In_ HDC hdc", "_In_reads_(uNumUFIs) PUNIVERSAL_FONT_ID pufiLinks", "_In_ ULONG uNumUFIs"], "addr": 30336}, "NtGdiSetTextJustification": {"args": ["_In_ HDC hdc", "_In_ int lBreakExtra", "_In_ int cBreak"], "addr": 30592}, "NtGdiWaitForTextReady": {"args": [], "addr": 31008}, "NtMITSetKeyboardInputRoutingPolicy": {"args": [], "addr": 32096}, "NtMinQSuspendInputProcessing": {"args": [], "addr": 32480}, "NtModerncoreBeginLayoutUpdate": {"args": [], "addr": 32544}, "NtModerncoreGetNavigationWindowVisual": {"args": [], "addr": 32736}, "NtQueryCompositionInputSinkViewId": {"args": [], "addr": 33312}, "NtRIMOnPnpNotification": {"args": [], "addr": 33920}, "NtUserAssociateInputContext": {"args": [], "addr": 35040}, "NtUserCitSetInfo": {"args": [], "addr": 35744}, "NtUserCompositionInputSinkLuidFromPoint": {"args": [], "addr": 35936}, "NtUserCreateEmptyCursorObject": {"args": [], "addr": 36192}, "NtUserCsDdeUninitialize": {"args": [], "addr": 36416}, "NtUserDeferWindowPosAndBand": {"args": [], "addr": 36544}, "NtUserDisplayConfigGetDeviceInfo": {"args": [], "addr": 37024}, "NtUserDisplayConfigSetDeviceInfo": {"args": [], "addr": 37056}, "NtUserFrostCrashedWindow": {"args": [], "addr": 38432}, "NtUserGetInputLocaleInfo": {"args": [], "addr": 39776}, "NtUserGetMenuItemRect": {"args": [], "addr": 40160}, "NtUserGetRawInputData": {"args": [], "addr": 41088}, "NtUserGetRawInputDeviceInfo": {"args": [], "addr": 41120}, "NtUserGetResizeDCompositionSynchronizationObject": {"args": [], "addr": 41280}, "NtUserGetUnpredictedMessagePos": {"args": [], "addr": 41600}, "NtUserGetWindowContextHelpId": {"args": [], "addr": 41824}, "NtUserGetWindowRgnEx": {"args": [], "addr": 41984}, "NtUserInitializeClientPfnArrays": {"args": [], "addr": 42592}, "NtUserInitializeInputDeviceInjection": {"args": [], "addr": 42656}, "NtUserInteractiveControlQueryUsage": {"args": [], "addr": 43008}, "NtUserIsMouseInputEnabled": {"args": [], "addr": 43168}, "NtUserLoadCursorsAndIcons": {"args": [], "addr": 43520}, "NtUserMNDragLeave": {"args": [], "addr": 43840}, "NtUserMagSetContextInformation": {"args": [], "addr": 43968}, "NtUserMessageBeep": {"args": [], "addr": 44128}, "NtUserQueryDisplayConfig": {"args": [], "addr": 44896}, "NtUserRealWaitMessageEx": {"args": [], "addr": 45056}, "NtUserRegisterForCustomDockTargets": {"args": [], "addr": 45376}, "NtUserRegisterLogonProcess": {"args": [], "addr": 45536}, "NtUserScheduleDispatchNotification": {"args": [], "addr": 46976}, "NtUserSendInteractiveControlHapticsReport": {"args": [], "addr": 47040}, "NtUserSetClassWord": {"args": [], "addr": 47456}, "NtUserSetDisplayAutoRotationPreferences": {"args": [], "addr": 47776}, "NtUserSetFeatureReportResponse": {"args": [], "addr": 47968}, "NtUserSetMsgBox": {"args": [], "addr": 48736}, "NtUserSetThreadQueueMergeSetting": {"args": [], "addr": 49504}, "NtUserShutdownReasonDestroy": {"args": [], "addr": 50336}, "NtUserSlicerControl": {"args": [], "addr": 50400}, "NtUserUndelegateInput": {"args": [], "addr": 50816}, "NtUserUpdateClientRect": {"args": [], "addr": 51040}, "NtUserUpdatePerUserImmEnabling": {"args": [], "addr": 51200}, "NtUserUpdateWindowInputSinkHints": {"args": [], "addr": 51296}, "NtUserSetWindowLongPtr": {"args": [], "addr": 51840}}};
var funcs_map = {};
var register_args = ["rcx", "rdx", "r8", "r9"];

function lib_includes(libname, liblist) {
  for (var i = 0; i < liblist.length; i++) {
    if (libname.toLowerCase() == liblist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function func_includes(funcname, funclist) {
  for (var i = 0; i < funclist.length; i++) {
    if (funcname.toLowerCase() == funclist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function mutate_n(n, ratio){
  return n + Math.floor(Math.random() * ratio) - ratio/2;
}

function mutate_buf(ptr, size, arg_i) {
  let buf = Memory.readByteArray(ptr, size);
  let buf_view = new Uint8Array(buf);
  // deep copy buf
  let new_buf = new ArrayBuffer(size);
  let new_buf_view = new Uint8Array(new_buf);
  for (let i = 0; i < size; i++) {
      if (Math.random() < 0.9) {
        new_buf_view[i] = buf_view[i];
      }else{
        new_buf_view[i] = mutate_n(buf_view[i], 10)
        }
    }
  Memory.writeByteArray(ptr, new_buf_view);
  console.log("Mutating buffer arg " + arg_i);
  console.log("From:");
  console.log(buf);
  console.log("To:");
  console.log(new_buf);
}

function mutate_args(context, args, f_args_infos) {
  let syscall_args = ["rcx", "rdx", "r8", "r9"];
  for (let i = 0; i < args.length; i++) {
    if (Memory.readPointer(args[i]) != 0 && Math.random() < 0.05)) {
       mutate_buf(Memory.readPointer(args[i]), 0x100, i);
    }
    else if (i < syscall_args.length && && Math.random() < 0.01) {
        let reg_name = syscall_args[i];
        // convert to int
        let reg_val = parseInt(args[i]);
        let new_val = mutate_n(reg_val, 10000);
        context[reg_name] = new_val;
        let hex_val = "0x" + new_val.toString(16);
        console.log("Mutating " + reg_name + " from " + args[i] + " to " + hex_val);
    }
  }
}


setTimeout(function() {
  Process.enumerateModules({
    onMatch: function(module) {
      //console.log("Found " + module.name + " at " + module.base);
      if (lib_includes(module.name, Object.keys(sys_data))) {
        let exports = module.enumerateExports();
        let module_name = module.name.toLowerCase();
        for (let f_name in sys_data[module_name]) {
          // call random function
          
          let infos = sys_data[module_name][f_name];
          let ea = infos["addr"]
          ea = module.base.add(ptr(ea));
          funcs_map[ea] = [f_name, module.name]
          try {
            //console.log("Hooking " + f_name + " at " + ea);
            Interceptor.attach(ea, {
              onEnter: function(args) {
                let f_name = funcs_map[this.context.pc][0];
                let module_name = funcs_map[this.context.pc][1];
                console.log(f_name); 
                let rcx = this.context.rcx;
                let rdx = this.context.rdx;
                let r8 = this.context.r8;
                let r9 = this.context.r9;
                let syscall_args = [rcx, rdx, r8, r9];
                let arg_index = 0;
                let stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                while (stack_arg != 0 && arg_index < 4) {
                  stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                  syscall_args.push(stack_arg);
                  arg_index++;
                }
                let f_args_infos = sys_data[module_name][f_name]["args"];
                for (let i = 0; i < syscall_args.length; i++) {
                  let arg_info = "";
                  if (i < f_args_infos.length) {
                    arg_info = f_args_infos[i];
                  }
                  console.log("Arg " + i + ": " + " " + arg_info + " " + syscall_args[i]);
                }
                mutate_args(this.context, syscall_args, f_args_infos);
                
              }
            });
          } catch (e) {
            console.log("Error: " + e);
          }
        }
      }
    },
    onComplete: function() {
    }
  });
}, 500);
