
var sys_data = {"ntdll.dll": {"ZwWorkerFactoryWorkerReady": {"args": [], "addr": 652160}, "ZwMapUserPhysicalPagesScatter": {"args": ["_In_reads_(NumberOfPages) PVOID *VirtualAddresses", "_In_ ULONG_PTR NumberOfPages", "_In_reads_opt_(NumberOfPages) PULONG_PTR UserPfnArray"], "addr": 652224}, "ZwDeviceIoControlFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ ULONG IoControlCode", "_In_reads_bytes_opt_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(OutputBufferLength) PVOID OutputBuffer", "_In_ ULONG OutputBufferLength"], "addr": 652352}, "ZwQueryInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID FileInformation", "_In_ ULONG Length", "_In_ FILE_INFORMATION_CLASS FileInformationClass"], "addr": 652672}, "ZwOpenKey": {"args": ["_Out_ PHANDLE KeyedEventHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 652704}, "ZwQueryDefaultLocale": {"args": ["_In_ BOOLEAN UserProfile", "_Out_ PLCID DefaultLocaleId"], "addr": 652800}, "ZwSetInformationProcess": {"args": ["_In_ HANDLE ProcessHandle", "_In_ PROCESSINFOCLASS ProcessInformationClass", "_In_reads_bytes_opt_(ProcessInformationLength) PVOID ProcessInformation", "_In_ ULONG ProcessInformationLength"], "addr": 653024}, "ZwQueryVirtualMemory": {"args": ["_In_ HANDLE ProcessHandle", "_In_opt_ PVOID BaseAddress", "_In_ MEMORY_INFORMATION_CLASS MemoryInformationClass", "_Out_writes_bytes_(MemoryInformationLength) PVOID MemoryInformation", "_In_ SIZE_T MemoryInformationLength", "_Out_opt_ PSIZE_T ReturnLength"], "addr": 653248}, "ZwTerminateProcess": {"args": ["_In_opt_ HANDLE ProcessHandle", "_In_ NTSTATUS ExitStatus"], "addr": 653536}, "ZwQueryPerformanceCounter": {"args": ["_Out_ PLARGE_INTEGER PerformanceCounter", "_Out_opt_ PLARGE_INTEGER PerformanceFrequency"], "addr": 653696}, "ZwOpenFile": {"args": ["_Out_ PHANDLE FileHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ ULONG ShareAccess", "_In_ ULONG OpenOptions"], "addr": 653760}, "ZwClearEvent": {"args": ["_In_ HANDLE EventHandle"], "addr": 654112}, "ZwQueueApcThread": {"args": ["_In_ HANDLE ThreadHandle", "_In_ PPS_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcArgument1", "_In_opt_ PVOID ApcArgument2", "_In_opt_ PVOID ApcArgument3"], "addr": 654336}, "ZwQueryVolumeInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID FsInformation", "_In_ ULONG Length", "_In_ FS_INFORMATION_CLASS FsInformationClass"], "addr": 654464}, "ZwCreateThread": {"args": ["_Out_ PHANDLE ThreadHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ HANDLE ProcessHandle", "_Out_ PCLIENT_ID ClientId", "_In_ PCONTEXT ThreadContext", "_In_ PINITIAL_TEB InitialTeb", "_In_ BOOLEAN CreateSuspended"], "addr": 654624}, "ZwQuerySection": {"args": ["_In_ HANDLE SectionHandle", "_In_ SECTION_INFORMATION_CLASS SectionInformationClass", "_Out_writes_bytes_(SectionInformationLength) PVOID SectionInformation", "_In_ SIZE_T SectionInformationLength", "_Out_opt_ PSIZE_T ReturnLength"], "addr": 654720}, "ZwCreateFile": {"args": ["_Out_ PHANDLE FileHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_opt_ PLARGE_INTEGER AllocationSize", "_In_ ULONG FileAttributes", "_In_ ULONG ShareAccess", "_In_ ULONG CreateDisposition", "_In_ ULONG CreateOptions", "_In_reads_bytes_opt_(EaLength) PVOID EaBuffer", "_In_ ULONG EaLength"], "addr": 654848}, "ZwWriteRequestData": {"args": ["_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE Message", "_In_ ULONG DataEntryIndex", "_In_reads_bytes_(BufferSize) PVOID Buffer", "_In_ SIZE_T BufferSize", "_Out_opt_ PSIZE_T NumberOfBytesWritten"], "addr": 654912}, "ZwOpenDirectoryObject": {"args": ["_Out_ PHANDLE DirectoryHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 654944}, "ZwCancelIoFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock"], "addr": 655088}, "ZwTraceEvent": {"args": ["_In_opt_ HANDLE TraceHandle", "_In_ ULONG Flags", "_In_ ULONG FieldSize", "_In_ PVOID Fields"], "addr": 655120}, "ZwPowerInformation": {"args": ["_In_ POWER_INFORMATION_LEVEL InformationLevel", "_In_reads_bytes_opt_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(OutputBufferLength) PVOID OutputBuffer", "_In_ ULONG OutputBufferLength"], "addr": 655152}, "ZwSetValueKey": {"args": ["_In_ HANDLE KeyHandle", "_In_opt_ PUNICODE_STRING ValueName", "_In_opt_ ULONG TitleIndex", "_In_ ULONG Type", "_In_reads_bytes_opt_(DataSize) PVOID Data", "_In_ ULONG DataSize"], "addr": 655184}, "ZwAccessCheckByType": {"args": ["_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ HANDLE ClientToken", "_In_ ACCESS_MASK DesiredAccess", "_In_reads_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_Out_writes_bytes_(*PrivilegeSetLength) PPRIVILEGE_SET PrivilegeSet", "_Inout_ PULONG PrivilegeSetLength", "_Out_ PACCESS_MASK GrantedAccess", "_Out_ PNTSTATUS AccessStatus"], "addr": 655280}, "ZwAccessCheckByTypeResultList": {"args": ["_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ HANDLE ClientToken", "_In_ ACCESS_MASK DesiredAccess", "_In_reads_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_Out_writes_bytes_(*PrivilegeSetLength) PPRIVILEGE_SET PrivilegeSet", "_Inout_ PULONG PrivilegeSetLength", "_Out_writes_(ObjectTypeListLength) PACCESS_MASK GrantedAccess", "_Out_writes_(ObjectTypeListLength) PNTSTATUS AccessStatus"], "addr": 655312}, "ZwAccessCheckByTypeResultListAndAuditAlarmByHandle": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ HANDLE ClientToken", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ ACCESS_MASK DesiredAccess", "_In_ AUDIT_EVENT_TYPE AuditType", "_In_ ULONG Flags", "_In_reads_opt_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_writes_(ObjectTypeListLength) PACCESS_MASK GrantedAccess", "_Out_writes_(ObjectTypeListLength) PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 655376}, "ZwAcquireProcessActivityReference": {"args": [], "addr": 655440}, "ZwAlertResumeThread": {"args": ["_In_ HANDLE ThreadHandle", "_Out_opt_ PULONG PreviousSuspendCount"], "addr": 655632}, "ZwAlertThread": {"args": ["_In_ HANDLE ThreadHandle"], "addr": 655664}, "ZwAlpcDeleteSectionView": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_In_ PVOID ViewBase"], "addr": 656272}, "ZwAlpcDisconnectPort": {"args": ["_In_ HANDLE PortHandle", "_In_ ULONG Flags"], "addr": 656336}, "ZwAlpcImpersonateClientOfPort": {"args": ["_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE Message", "_In_ PVOID Flags"], "addr": 656400}, "ZwAlpcOpenSenderThread": {"args": ["_Out_ PHANDLE ThreadHandle", "_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE PortMessage", "_In_ ULONG Flags", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 656464}, "ZwAreMappedFilesTheSame": {"args": ["_In_ PVOID File1MappedAsAnImage", "_In_ PVOID File2MappedAsFile"], "addr": 656656}, "ZwAssociateWaitCompletionPacket": {"args": ["_In_ HANDLE WaitCompletionPacketHandle", "_In_ HANDLE IoCompletionHandle", "_In_ HANDLE TargetObjectHandle", "_In_opt_ PVOID KeyContext", "_In_opt_ PVOID ApcContext", "_In_ NTSTATUS IoStatus", "_In_ ULONG_PTR IoStatusInformation", "_Out_opt_ PBOOLEAN AlreadySignaled"], "addr": 656720}, "ZwCancelTimer2": {"args": ["_In_ HANDLE TimerHandle", "_In_ PT2_CANCEL_PARAMETERS Parameters"], "addr": 656848}, "ZwContinueEx": {"args": [], "addr": 657328}, "ZwCreateDirectoryObjectEx": {"args": ["_Out_ PHANDLE DirectoryHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ HANDLE ShadowDirectoryHandle", "_In_ ULONG Flags"], "addr": 657584}, "ZwCreateEventPair": {"args": ["_Out_ PHANDLE EventPairHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 657680}, "ZwCreateKeyedEvent": {"args": ["_Out_ PHANDLE KeyedEventHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG Flags"], "addr": 657904}, "ZwCreatePort": {"args": ["_Out_ PHANDLE PortHandle", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ ULONG MaxConnectionInfoLength", "_In_ ULONG MaxMessageLength", "_In_opt_ ULONG MaxPoolUsage"], "addr": 658128}, "ZwCreateProcessStateChange": {"args": [], "addr": 658224}, "ZwCreateThreadStateChange": {"args": [], "addr": 658512}, "ZwCreateTimer2": {"args": ["_Out_ PHANDLE TimerHandle", "_In_opt_ PVOID Reserved1", "_In_opt_ PVOID Reserved2", "_In_ ULONG Attributes", "_In_ ACCESS_MASK DesiredAccess"], "addr": 658576}, "ZwCreateTransaction": {"args": ["_Out_ PHANDLE TmHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PUNICODE_STRING LogFileName", "_In_opt_ ULONG CreateOptions", "_In_opt_ ULONG CommitStrength"], "addr": 658672}, "ZwCreateWaitCompletionPacket": {"args": ["_Out_ PHANDLE WaitCompletionPacketHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 658768}, "ZwDebugActiveProcess": {"args": [], "addr": 658896}, "ZwDeleteDriverEntry": {"args": ["_In_ ULONG Id"], "addr": 659024}, "ZwDeletePrivateNamespace": {"args": ["_In_ HANDLE NamespaceHandle"], "addr": 659152}, "ZwEnumerateBootEntries": {"args": ["_Out_writes_bytes_opt_(*BufferLength) PVOID Buffer", "_Inout_ PULONG BufferLength"], "addr": 659440}, "ZwFlushKey": {"args": ["_In_ HANDLE KeyHandle"], "addr": 659792}, "ZwGetContextThread": {"args": ["_In_ HANDLE ThreadHandle", "_Inout_ PCONTEXT ThreadContext"], "addr": 660080}, "ZwGetCurrentProcessorNumberEx": {"args": ["_Out_ PPROCESSOR_NUMBER ProcNumber"], "addr": 660144}, "ZwGetMUIRegistryInfo": {"args": ["_In_ ULONG Flags", "_Inout_opt_ ULONG *DataSize", "_Inout_updates_bytes_opt_(*DataSize) PVOID Data"], "addr": 660208}, "ZwGetWriteWatch": {"args": ["_In_ HANDLE ProcessHandle", "_In_ ULONG Flags", "_In_ PVOID BaseAddress", "_In_ SIZE_T RegionSize", "_Out_writes_opt_(*EntriesInUserAddressArray) PVOID *UserAddressArray", "_Inout_opt_ PULONG_PTR EntriesInUserAddressArray", "_Out_opt_ PULONG Granularity"], "addr": 660368}, "ZwInitializeNlsFiles": {"args": ["_Outptr_result_bytebuffer_(sizeof(NLS_MAIN_TABLE_OFFSET)) PVOID *BaseAddress", "_Out_ PLCID DefaultLocaleId", "_Out_ PLARGE_INTEGER DefaultCasingTableSize"], "addr": 660496}, "ZwIsSystemResumeAutomatic": {"args": [], "addr": 660592}, "ZwLoadDriver": {"args": ["_In_ PUNICODE_STRING DriverServiceName"], "addr": 660688}, "ZwLockFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ PLARGE_INTEGER ByteOffset", "_In_ PLARGE_INTEGER Length", "_In_ ULONG Key", "_In_ BOOLEAN FailImmediately", "_In_ BOOLEAN ExclusiveLock"], "addr": 660880}, "ZwMakePermanentObject": {"args": ["_In_ HANDLE Handle"], "addr": 661008}, "ZwManageHotPatch": {"args": [], "addr": 661072}, "ZwManagePartition": {"args": ["_In_ HANDLE TargetHandle", "_In_opt_ HANDLE SourceHandle", "_In_ MEMORY_PARTITION_INFORMATION_CLASS PartitionInformationClass", "_In_ PVOID PartitionInformation", "_In_ ULONG PartitionInformationLength"], "addr": 661104}, "ZwMapViewOfSectionEx": {"args": [], "addr": 661200}, "ZwOpenMutant": {"args": ["_Out_ PHANDLE MutantHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661744}, "ZwOpenResourceManager": {"args": ["_Out_ PHANDLE ResourceManagerHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ HANDLE TmHandle", "_In_opt_ LPGUID ResourceManagerGuid", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661936}, "ZwOpenSemaphore": {"args": ["_Out_ PHANDLE SemaphoreHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661968}, "ZwPlugPlayControl": {"args": ["_In_ PLUGPLAY_CONTROL_CLASS PnPControlClass", "_Inout_updates_bytes_(PnPControlDataLength) PVOID PnPControlData", "_In_ ULONG PnPControlDataLength"], "addr": 662192}, "ZwPrepareComplete": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 662288}, "ZwPssCaptureVaSpaceBulk": {"args": [], "addr": 662512}, "ZwPulseEvent": {"args": ["_In_ HANDLE EventHandle", "_Out_opt_ PLONG PreviousState"], "addr": 662544}, "ZwQueryAuxiliaryCounterFrequency": {"args": [], "addr": 662576}, "ZwQueryDriverEntryOrder": {"args": ["_Out_writes_opt_(*Count) PULONG Ids", "_Inout_ PULONG Count"], "addr": 662768}, "ZwQueryInformationAtom": {"args": ["_In_ RTL_ATOM Atom", "_In_ ATOM_INFORMATION_CLASS AtomInformationClass", "_Out_writes_bytes_(AtomInformationLength) PVOID AtomInformation", "_In_ ULONG AtomInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 662864}, "ZwQueryInformationByName": {"args": [], "addr": 662896}, "ZwQueryInformationCpuPartition": {"args": [], "addr": 662928}, "ZwQueryInformationPort": {"args": ["_In_opt_ HANDLE PortHandle", "_In_ __drv_strictTypeMatch(__drv_typeConst) PORT_INFORMATION_CLASS PortInformationClass", "_Out_writes_bytes_to_(Length,*ReturnLength) PVOID PortInformation", "_In_ ULONG Length", "_Out_opt_ PULONG ReturnLength"], "addr": 663024}, "ZwQueryInformationTransaction": {"args": ["_In_ HANDLE TransactionManagerHandle", "_In_ TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass", "_Out_writes_bytes_(TransactionManagerInformationLength) PVOID TransactionManagerInformation", "_In_ ULONG TransactionManagerInformationLength", "_Out_ PULONG ReturnLength"], "addr": 663088}, "ZwQueryMultipleValueKey": {"args": ["_In_ HANDLE KeyHandle", "_Inout_updates_(EntryCount) PKEY_VALUE_ENTRY ValueEntries", "_In_ ULONG EntryCount", "_Out_writes_bytes_(*BufferLength) PVOID ValueBuffer", "_Inout_ PULONG BufferLength", "_Out_opt_ PULONG RequiredBufferLength"], "addr": 663344}, "ZwQueryQuotaInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID Buffer", "_In_ ULONG Length", "_In_ BOOLEAN ReturnSingleEntry", "_In_reads_bytes_opt_(SidListLength) PVOID SidList", "_In_ ULONG SidListLength", "_In_reads_bytes_opt_((8 + (4 * ((SID *)StartSid)->SubAuthorityCount))) // SeLengthSid()\n    PSID StartSid", "_In_ BOOLEAN RestartScan"], "addr": 663504}, "ZwQuerySecurityPolicy": {"args": [], "addr": 663600}, "ZwQuerySystemEnvironmentValue": {"args": ["_In_ PUNICODE_STRING VariableName", "_Out_writes_bytes_(ValueLength) PWSTR VariableValue", "_In_ USHORT ValueLength", "_Out_opt_ PUSHORT ReturnLength"], "addr": 663696}, "ZwQuerySystemInformationEx": {"args": ["_In_ SYSTEM_INFORMATION_CLASS SystemInformationClass", "_In_reads_bytes_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(SystemInformationLength) PVOID SystemInformation", "_In_ ULONG SystemInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 663760}, "ZwRollbackComplete": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 664720}, "ZwRollbackEnlistment": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 664752}, "ZwRollbackTransaction": {"args": ["_In_ HANDLE TransactionHandle", "_In_ BOOLEAN Wait"], "addr": 664816}, "ZwSetInformationDebugObject": {"args": [], "addr": 665520}, "ZwSetInformationIoRing": {"args": [], "addr": 665584}, "ZwSetInformationResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle", "_In_ RESOURCEMANAGER_INFORMATION_CLASS ResourceManagerInformationClass", "_In_reads_bytes_(ResourceManagerInformationLength) PVOID ResourceManagerInformation", "_In_ ULONG ResourceManagerInformationLength"], "addr": 665680}, "ZwSetSecurityObject": {"args": ["_In_ HANDLE Handle", "_In_ SECURITY_INFORMATION SecurityInformation", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor"], "addr": 666128}, "ZwSetSystemPowerState": {"args": ["_In_ POWER_ACTION SystemAction", "_In_ SYSTEM_POWER_STATE LightestSystemState", "_In_ ULONG Flags         // POWER_ACTION_xxx flags"], "addr": 666256}, "ZwSetTimerResolution": {"args": ["_In_ ULONG DesiredTime", "_In_ BOOLEAN SetResolution", "_Out_ PULONG ActualTime"], "addr": 666416}, "ZwSetVolumeInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_reads_bytes_(Length) PVOID FsInformation", "_In_ ULONG Length", "_In_ FS_INFORMATION_CLASS FsInformationClass"], "addr": 666480}, "ZwShutdownSystem": {"args": ["_In_ SHUTDOWN_ACTION Action"], "addr": 666544}, "ZwStartProfile": {"args": ["_In_ HANDLE ProfileHandle"], "addr": 666672}, "ZwTerminateEnclave": {"args": [], "addr": 666896}, "ZwTraceControl": {"args": ["_In_ ULONG FunctionCode", "_In_reads_bytes_opt_(InBufferLen) PVOID InBuffer", "_In_ ULONG InBufferLen", "_Out_writes_bytes_opt_(OutBufferLen) PVOID OutBuffer", "_In_ ULONG OutBufferLen", "_Out_ PULONG ReturnSize"], "addr": 667056}, "ZwUmsThreadYield": {"args": ["_In_ PVOID SchedulerParam"], "addr": 667120}, "ZwUnloadKey2": {"args": ["_In_ POBJECT_ATTRIBUTES  TargetKey", "_In_ ULONG        Flags"], "addr": 667216}}, "win32u.dll": {"NtUserSetTimer": {"args": [], "addr": 5984}, "NtUserEndPaint": {"args": [], "addr": 6016}, "NtUserEndDeferWindowPosEx": {"args": [], "addr": 6400}, "NtGdiGetDCDword": {"args": ["_In_ HDC hdc", "_In_ UINT u", "_Out_ DWORD *Result"], "addr": 7136}, "NtGdiCreateCompatibleDC": {"args": ["_In_opt_ HDC hdc"], "addr": 7808}, "NtGdiGetWidthTable": {"args": ["_In_ HDC hdc", "_In_ ULONG cSpecial", "_In_reads_(cwc) const WCHAR *pwc", "_In_ ULONG cwc", "_Out_writes_(cwc) USHORT *psWidth", "_Out_opt_ WIDTHDATA *pwd", "_Out_ FLONG *pflInfo"], "addr": 8448}, "NtGdiGetNearestColor": {"args": ["_In_ HDC hdc", "_In_ COLORREF cr"], "addr": 8672}, "NtUserCalcMenuBar": {"args": [], "addr": 9856}, "NtUserThunkedMenuItemInfo": {"args": [], "addr": 9888}, "NtGdiCreateDIBSection": {"args": ["_In_opt_ HDC hdc", "_In_opt_ HANDLE hSectionApp", "_In_ DWORD dwOffset", "_In_reads_bytes_opt_(cjHeader) LPBITMAPINFO pbmi", "_In_ DWORD iUsage", "_In_ UINT cjHeader", "_In_ FLONG fl", "_In_ ULONG_PTR dwColorSpace", "_Outptr_ PVOID *ppvBits"], "addr": 9952}, "NtUserSetCursorIconData": {"args": [], "addr": 10144}, "NtUserOpenDesktop": {"args": [], "addr": 10208}, "NtUserScrollWindowEx": {"args": [], "addr": 10912}, "NtGdiFillRgn": {"args": ["_In_ HDC hdc", "_In_ HRGN hrgn", "_In_ HBRUSH hbrush"], "addr": 11456}, "NtGdiSetMiterLimit": {"args": ["_In_ HDC hdc", "_In_ DWORD dwNew", "_Inout_opt_ PDWORD pdwOut"], "addr": 12000}, "NtUserEmptyClipboard": {"args": [], "addr": 12608}, "NtGdiSetFontEnumeration": {"args": ["_In_ ULONG ulType"], "addr": 13600}, "NtDCompositionCreateAndBindSharedSection": {"args": [], "addr": 14336}, "NtDCompositionCreateChannel": {"args": [], "addr": 14368}, "NtDCompositionCreateConnection": {"args": [], "addr": 14400}, "NtDCompositionDestroyChannel": {"args": [], "addr": 14528}, "NtDCompositionGetTargetStatistics": {"args": [], "addr": 15040}, "NtDCompositionWaitForCompositorClock": {"args": [], "addr": 15680}, "NtDxgkCancelPresents": {"args": [], "addr": 15776}, "NtDxgkCheckSinglePlaneForMultiPlaneOverlaySupport": {"args": [], "addr": 15808}, "NtFlipObjectDisconnectEndpoint": {"args": [], "addr": 17088}, "NtFlipObjectQueryBufferAvailableEvent": {"args": [], "addr": 17216}, "NtGdiAddRemoteMMInstanceToDC": {"args": ["_In_ HDC hdc", "_In_reads_bytes_(cjDDV) DOWNLOADDESIGNVECTOR *pddv", "_In_ ULONG cjDDV"], "addr": 17664}, "NtGdiBRUSHOBJ_pvGetRbrush": {"args": ["_In_ BRUSHOBJ *pbo"], "addr": 17888}, "NtGdiDdDDIEvict": {"args": [], "addr": 20640}, "NtGdiDdDDILock2": {"args": [], "addr": 21728}, "NtGdiDdDDINetDispQueryMiracastDisplayDeviceSupport": {"args": [], "addr": 21920}, "NtGdiDdDDIReleaseSwapChain": {"args": [], "addr": 23488}, "NtGdiDdDDISetGammaRamp": {"args": [], "addr": 23808}, "NtGdiDdDDISubmitSignalSyncObjectsToHwQueue": {"args": [], "addr": 24544}, "NtGdiDdDestroyFullscreenSprite": {"args": ["_In_ HDC hdc", "_In_ HANDLE hSprite"], "addr": 25024}, "NtGdiDestroyPhysicalMonitor": {"args": [], "addr": 25216}, "NtGdiGetCurrentDpiInfo": {"args": ["_In_ HMONITOR hmon", "_Out_ DPI_INFORMATION* dpiInfo"], "addr": 27392}, "NtGdiGetDCDpiScaleValue": {"args": ["_In_ HDC hdc"], "addr": 27424}, "NtGdiGetEmbUFI": {"args": ["_In_ HDC hdc", "_Out_ PUNIVERSAL_FONT_ID pufi", "_Out_opt_ DESIGNVECTOR *pdv", "_Out_ ULONG *pcjDV", "_Out_ ULONG *pulBaseCheckSum", "_Out_ FLONG *pfl", "_Out_ KERNEL_PVOID *embFontID"], "addr": 27616}, "NtGdiGetFontFileInfo": {"args": ["_In_         UINT       uFileCollectionID", "_In_         UINT       uFileIndex", "_Out_writes_bytes_(cbSize) FONT_FILE_INFO * pfi", "_In_         SIZE_T      cbSize", "_Out_opt_      SIZE_T *     pcbActualSize"], "addr": 27776}, "NtGdiGetMonitorID": {"args": ["_In_ HDC hdc", "_In_ DWORD dwSize", "_Out_writes_bytes_(dwSize) LPWSTR pszMonitorID"], "addr": 28064}, "NtGdiGetPath": {"args": ["_In_ HDC hdc", "_Out_writes_opt_(cptBuf) LPPOINT pptlBuf", "_Out_writes_opt_(cptBuf) LPBYTE pjTypes", "_In_ int cptBuf"], "addr": 28224}, "NtGdiGetPhysicalMonitorDescription": {"args": [], "addr": 28288}, "NtGdiInitSpool": {"args": [], "addr": 28928}, "NtGdiResetDC": {"args": [], "addr": 29664}, "NtGdiSelectBrush": {"args": ["_In_ HDC hdc", "_In_ HBRUSH hbrush"], "addr": 30048}, "NtGdiSetSystemPaletteUse": {"args": ["_In_ HDC hdc", "_In_ UINT ui"], "addr": 30560}, "NtGdiStartDoc": {"args": ["_In_ HDC hdc", "_In_ DOCINFOW *pdi", "_Out_ BOOL *pbBanding", "_In_ INT iJob"], "addr": 30656}, "NtGdiWaitForTextReady": {"args": [], "addr": 31008}, "NtMITCoreMsgKOpenConnectionTo": {"args": [], "addr": 31520}, "NtMITSynthesizeKeyboardInput": {"args": [], "addr": 32192}, "NtModerncoreCreateDCompositionHwndTarget": {"args": [], "addr": 32576}, "NtModerncoreIsResizeLayoutSynchronizationEnabled": {"args": [], "addr": 32864}, "NtQueryCompositionInputSink": {"args": [], "addr": 33248}, "NtUserCreatePopupMenu": {"args": [], "addr": 36320}, "NtUserFlashWindowEx": {"args": [], "addr": 38336}, "NtUserGetCursorInfo": {"args": [], "addr": 38976}, "NtUserGetCursorPos": {"args": [], "addr": 39008}, "NtUserGetDesktopID": {"args": [], "addr": 39104}, "NtUserGetDesktopVisualTransform": {"args": [], "addr": 39136}, "NtUserGetGestureExtArgs": {"args": [], "addr": 39424}, "NtUserGetGuiResources": {"args": [], "addr": 39488}, "NtUserGetIMEShowStatus": {"args": [], "addr": 39584}, "NtUserGetKeyboardLayoutName": {"args": [], "addr": 40000}, "NtUserGetPointerDevice": {"args": [], "addr": 40416}, "NtUserGetRegisteredRawInputDevices": {"args": [], "addr": 41216}, "NtUserGetWinStationInfo": {"args": [], "addr": 41696}, "NtUserHardErrorControl": {"args": [], "addr": 42176}, "NtUserInitRunThread": {"args": [], "addr": 42496}, "NtUserInitThreadCoreMessagingIocp": {"args": [], "addr": 42528}, "NtUserIsMouseInPointerEnabled": {"args": [], "addr": 43136}, "NtUserPostKeyboardInputMessage": {"args": [], "addr": 44640}, "NtUserQueryInformationThread": {"args": [], "addr": 44928}, "NtUserQueryInputContext": {"args": [], "addr": 44960}, "NtUserRealWaitMessageEx": {"args": [], "addr": 45056}, "NtUserRedrawTitle": {"args": [], "addr": 45216}, "NtUserRegisterLogonProcess": {"args": [], "addr": 45536}, "NtUserRegisterTouchHitTestingWindow": {"args": [], "addr": 45920}, "NtUserSendInteractiveControlHapticsReport": {"args": [], "addr": 47040}, "NtUserSetInputServiceState": {"args": [], "addr": 48256}, "NtUserSetTSFEventState": {"args": [], "addr": 49344}, "NtUserSetWindowCompositionTransition": {"args": [], "addr": 49696}, "NtUserSetWindowFeedbackSetting": {"args": [], "addr": 49792}, "NtUserThreadMessageQueueAttached": {"args": [], "addr": 50656}, "NtUserTraceLoggingSendMixedModeTelemetry": {"args": [], "addr": 50688}, "NtUserUnregisterHotKey": {"args": [], "addr": 50944}, "NtUserUnregisterSessionPort": {"args": [], "addr": 50976}, "NtUserUpdateClientRect": {"args": [], "addr": 51040}, "NtUserUpdateLayeredWindow": {"args": [], "addr": 51168}, "NtUserWaitForInputIdle": {"args": [], "addr": 51552}}};
var funcs_map = {};
var register_args = ["rcx", "rdx", "r8", "r9"];

function lib_includes(libname, liblist) {
  for (var i = 0; i < liblist.length; i++) {
    if (libname.toLowerCase() == liblist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function func_includes(funcname, funclist) {
  for (var i = 0; i < funclist.length; i++) {
    if (funcname.toLowerCase() == funclist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function mutate_n(n, ratio){
  return n + Math.floor(Math.random() * ratio) - ratio/2;
}

function mutate_buf(ptr, size, arg_i) {
  let buf = Memory.readByteArray(ptr, size);
  let buf_view = new Uint8Array(buf);
  // deep copy buf
  let new_buf = new ArrayBuffer(size);
  let new_buf_view = new Uint8Array(new_buf);
  for (let i = 0; i < size; i++) {
      if (Math.random() < 0.9) {
        new_buf_view[i] = buf_view[i];
      }else{
        new_buf_view[i] = mutate_n(buf_view[i], 10)
        }
    }
  Memory.writeByteArray(ptr, new_buf_view);
  console.log("Mutating buffer arg " + arg_i);
  console.log("From:");
  console.log(buf);
  console.log("To:");
  console.log(new_buf);
}

function mutate_args(context, args, f_args_infos) {
  let syscall_args = ["rcx", "rdx", "r8", "r9"];
  for (let i = 0; i < args.length; i++) {
    if(Math.random() > 0.05){
        continue;
    }
    if (Memory.readPointer(args[i]) != 0) {
       mutate_buf(Memory.readPointer(args[i]), 0x100, i);
    }
    else if (i < syscall_args.length) {
        let reg_name = syscall_args[i];
        // convert to int
        let reg_val = parseInt(args[i]);
        let new_val = mutate_n(reg_val, 10000);
        context[reg_name] = new_val;
        let hex_val = "0x" + new_val.toString(16);
        console.log("Mutating " + reg_name + " from " + args[i] + " to " + hex_val);
    }
  }
}


setTimeout(function() {
  Process.enumerateModules({
    onMatch: function(module) {
      //console.log("Found " + module.name + " at " + module.base);
      if (lib_includes(module.name, Object.keys(sys_data))) {
        let exports = module.enumerateExports();
        let module_name = module.name.toLowerCase();
        for (let f_name in sys_data[module_name]) {
          // call random function
          
          let infos = sys_data[module_name][f_name];
          let ea = infos["addr"]
          ea = module.base.add(ptr(ea));
          funcs_map[ea] = [f_name, module.name]
          try {
            //console.log("Hooking " + f_name + " at " + ea);
            Interceptor.attach(ea, {
              onEnter: function(args) {
                let f_name = funcs_map[this.context.pc][0];
                let module_name = funcs_map[this.context.pc][1];
                console.log(f_name); 
                let rcx = this.context.rcx;
                let rdx = this.context.rdx;
                let r8 = this.context.r8;
                let r9 = this.context.r9;
                let syscall_args = [rcx, rdx, r8, r9];
                let arg_index = 0;
                let stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                while (stack_arg != 0 && arg_index < 4) {
                  stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                  syscall_args.push(stack_arg);
                  arg_index++;
                }
                let f_args_infos = sys_data[module_name][f_name]["args"];
                for (let i = 0; i < syscall_args.length; i++) {
                  let arg_info = "";
                  if (i < f_args_infos.length) {
                    arg_info = f_args_infos[i];
                  }
                  console.log("Arg " + i + ": " + " " + arg_info + " " + syscall_args[i]);
                }
                mutate_args(this.context, syscall_args, f_args_infos);
                
              }
            });
          } catch (e) {
            console.log("Error: " + e);
          }
        }
      }
    },
    onComplete: function() {
    }
  });
}, 500);
