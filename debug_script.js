
var sys_data = {"ntdll.dll": {"sub_9EF10": {"args": [], "addr": 651024}, "sub_9EF70": {"args": [], "addr": 651120}, "ZwWorkerFactoryWorkerReady": {"args": [], "addr": 652160}, "ZwWriteFile": {"args": ["_In_ HANDLE FileHandle", "_In_opt_ HANDLE Event", "_In_opt_ PIO_APC_ROUTINE ApcRoutine", "_In_opt_ PVOID ApcContext", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_ PFILE_SEGMENT_ELEMENT SegmentArray", "_In_ ULONG Length", "_In_opt_ PLARGE_INTEGER ByteOffset", "_In_opt_ PULONG Key"], "addr": 652384}, "ZwClose": {"args": ["_In_ HANDLE Handle"], "addr": 652608}, "ZwEnumerateValueKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ ULONG Index", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_VALUE_INFORMATION_CLASS KeyValueInformationClass", "_Out_writes_bytes_opt_(Length) PVOID KeyValueInformation", "_In_ ULONG Length", "_Out_ PULONG ResultLength"], "addr": 652736}, "ZwFindAtom": {"args": ["_In_reads_bytes_opt_(Length) PWSTR AtomName", "_In_ ULONG Length", "_Out_opt_ PRTL_ATOM Atom"], "addr": 652768}, "ZwQueryKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_INFORMATION_CLASS KeyInformationClass", "_Out_writes_bytes_opt_(Length) PVOID KeyInformation", "_In_ ULONG Length", "_Out_ PULONG ResultLength"], "addr": 652832}, "ZwWaitForMultipleObjects32": {"args": ["_In_ ULONG Count", "_In_reads_(Count) LONG Handles[]", "_In_ WAIT_TYPE WaitType", "_In_ BOOLEAN Alertable", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 652960}, "ZwQueryInformationThread": {"args": ["_In_ HANDLE ThreadHandle", "_In_ THREADINFOCLASS ThreadInformationClass", "_Out_writes_bytes_(ThreadInformationLength) PVOID ThreadInformation", "_In_ ULONG ThreadInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 653312}, "ZwOpenProcess": {"args": ["_Out_ PHANDLE ProcessHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PCLIENT_ID ClientId"], "addr": 653344}, "ZwMapViewOfSection": {"args": ["_In_ HANDLE SectionHandle", "_In_ HANDLE ProcessHandle", "_Inout_ _At_ (*BaseAddress,_Readable_bytes_ (*ViewSize) _Writable_bytes_ (*ViewSize) _Post_readable_byte_size_ (*ViewSize)) PVOID *BaseAddress", "_In_ ULONG_PTR ZeroBits", "_In_ SIZE_T CommitSize", "_Inout_opt_ PLARGE_INTEGER SectionOffset", "_Inout_ PSIZE_T ViewSize", "_In_ SECTION_INHERIT InheritDisposition", "_In_ ULONG AllocationType", "_In_ ULONG Win32Protect"], "addr": 653408}, "ZwAccessCheckAndAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_ ACCESS_MASK DesiredAccess", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_ PACCESS_MASK GrantedAccess", "_Out_ PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 653440}, "ZwReplyWaitReceivePortEx": {"args": ["_In_ HANDLE PortHandle", "_Out_opt_ PVOID *PortContext", "_In_reads_bytes_opt_(ReplyMessage->u1.s1.TotalLength) PPORT_MESSAGE ReplyMessage", "_Out_ PPORT_MESSAGE ReceiveMessage", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 653504}, "ZwQueryPerformanceCounter": {"args": ["_Out_ PLARGE_INTEGER PerformanceCounter", "_Out_opt_ PLARGE_INTEGER PerformanceFrequency"], "addr": 653696}, "ZwEnumerateKey": {"args": ["_In_ HANDLE KeyHandle", "_In_ ULONG Index", "_In_ __drv_strictTypeMatch(__drv_typeConst)\nKEY_INFORMATION_CLASS KeyInformationClass", "_Out_writes_bytes_opt_(Length) PVOID KeyInformation", "_In_ ULONG Length", "_Out_ PULONG ResultLength"], "addr": 653728}, "ZwClearEvent": {"args": ["_In_ HANDLE EventHandle"], "addr": 654112}, "ZwYieldExecution": {"args": ["VOID"], "addr": 654368}, "ZwAddAtom": {"args": ["_In_reads_bytes_opt_(Length) PWSTR AtomName", "_In_ ULONG Length", "_Out_opt_ PRTL_ATOM Atom"], "addr": 654400}, "ZwApphelpCacheControl": {"args": [], "addr": 654560}, "ZwReadRequestData": {"args": ["_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE Message", "_In_ ULONG DataEntryIndex", "_Out_writes_bytes_to_(BufferSize,*NumberOfBytesRead) PVOID Buffer", "_In_ SIZE_T BufferSize", "_Out_opt_ PSIZE_T NumberOfBytesRead"], "addr": 654816}, "ZwCreateFile": {"args": ["_Out_ PHANDLE FileHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_opt_ PLARGE_INTEGER AllocationSize", "_In_ ULONG FileAttributes", "_In_ ULONG ShareAccess", "_In_ ULONG CreateDisposition", "_In_ ULONG CreateOptions", "_In_reads_bytes_opt_(EaLength) PVOID EaBuffer", "_In_ ULONG EaLength"], "addr": 654848}, "ZwWriteRequestData": {"args": ["_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE Message", "_In_ ULONG DataEntryIndex", "_In_reads_bytes_(BufferSize) PVOID Buffer", "_In_ SIZE_T BufferSize", "_Out_opt_ PSIZE_T NumberOfBytesWritten"], "addr": 654912}, "ZwPowerInformation": {"args": ["_In_ POWER_INFORMATION_LEVEL InformationLevel", "_In_reads_bytes_opt_(InputBufferLength) PVOID InputBuffer", "_In_ ULONG InputBufferLength", "_Out_writes_bytes_opt_(OutputBufferLength) PVOID OutputBuffer", "_In_ ULONG OutputBufferLength"], "addr": 655152}, "ZwAccessCheckByTypeResultListAndAuditAlarmByHandle": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ HANDLE ClientToken", "_In_ PUNICODE_STRING ObjectTypeName", "_In_ PUNICODE_STRING ObjectName", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor", "_In_opt_ PSID PrincipalSelfSid", "_In_ ACCESS_MASK DesiredAccess", "_In_ AUDIT_EVENT_TYPE AuditType", "_In_ ULONG Flags", "_In_reads_opt_(ObjectTypeListLength) POBJECT_TYPE_LIST ObjectTypeList", "_In_ ULONG ObjectTypeListLength", "_In_ PGENERIC_MAPPING GenericMapping", "_In_ BOOLEAN ObjectCreation", "_Out_writes_(ObjectTypeListLength) PACCESS_MASK GrantedAccess", "_Out_writes_(ObjectTypeListLength) PNTSTATUS AccessStatus", "_Out_ PBOOLEAN GenerateOnClose"], "addr": 655376}, "ZwAddBootEntry": {"args": ["_In_ PBOOT_ENTRY BootEntry", "_Out_opt_ PULONG Id"], "addr": 655504}, "ZwAddDriverEntry": {"args": ["_In_ PEFI_DRIVER_ENTRY DriverEntry", "_Out_opt_ PULONG Id"], "addr": 655536}, "ZwAlpcCancelMessage": {"args": ["_In_ HANDLE PortHandle", "_In_ ULONG Flags", "_In_ PALPC_CONTEXT_ATTR MessageContext"], "addr": 655952}, "ZwAlpcCreateSecurityContext": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_Inout_ PALPC_SECURITY_ATTR SecurityAttr"], "addr": 656176}, "ZwAlpcDeletePortSection": {"args": ["_In_ HANDLE PortHandle", "_Reserved_ ULONG Flags", "_In_ ALPC_HANDLE SectionHandle"], "addr": 656208}, "ZwAlpcOpenSenderProcess": {"args": ["_Out_ PHANDLE ProcessHandle", "_In_ HANDLE PortHandle", "_In_ PPORT_MESSAGE PortMessage", "_In_ ULONG Flags", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 656432}, "ZwCancelTimer2": {"args": ["_In_ HANDLE TimerHandle", "_In_ PT2_CANCEL_PARAMETERS Parameters"], "addr": 656848}, "ZwCommitComplete": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 656976}, "ZwCompactKeys": {"args": ["_In_ ULONG Count", "_In_reads_(Count) HANDLE KeyArray[]"], "addr": 657104}, "ZwCreateEnlistment": {"args": ["_Out_ PHANDLE EnlistmentHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ HANDLE ResourceManagerHandle", "_In_ HANDLE TransactionHandle", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ ULONG CreateOptions", "_In_ NOTIFICATION_MASK NotificationMask", "_In_opt_ PVOID EnlistmentKey"], "addr": 657648}, "ZwCreateEventPair": {"args": ["_Out_ PHANDLE EventPairHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 657680}, "ZwCreateIoCompletion": {"args": ["_Out_ PHANDLE IoCompletionHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ ULONG Count"], "addr": 657744}, "ZwCreateIoRing": {"args": [], "addr": 657776}, "ZwCreateRegistryTransaction": {"args": [], "addr": 658320}, "ZwCreateSectionEx": {"args": [], "addr": 658384}, "ZwCreateThreadEx": {"args": ["_Out_ PHANDLE ThreadHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_ HANDLE ProcessHandle", "_In_ PVOID /* PUSER_THREAD_START_ROUTINE */ StartRoutine", "_In_opt_ PVOID Argument", "_In_ ULONG CreateFlags", "_In_ SIZE_T ZeroBits", "_In_ SIZE_T StackSize", "_In_ SIZE_T MaximumStackSize", "_In_opt_ PPS_ATTRIBUTE_LIST AttributeList"], "addr": 658480}, "ZwCreateUserProcess": {"args": ["_Out_ PHANDLE ProcessHandle", "_Out_ PHANDLE ThreadHandle", "_In_ ACCESS_MASK ProcessDesiredAccess", "_In_ ACCESS_MASK ThreadDesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ProcessObjectAttributes", "_In_opt_ POBJECT_ATTRIBUTES ThreadObjectAttributes", "_In_ ULONG ProcessFlags", "_In_ ULONG ThreadFlags", "_In_opt_ PVOID  ProcessParameters", "_Inout_ PPS_CREATE_INFO CreateInfo", "_In_opt_ PPS_ATTRIBUTE_LIST AttributeList"], "addr": 658736}, "ZwDeleteObjectAuditAlarm": {"args": ["_In_ PUNICODE_STRING SubsystemName", "_In_opt_ PVOID HandleId", "_In_ BOOLEAN GenerateOnClose"], "addr": 659120}, "ZwDisplayString": {"args": ["_In_ PUNICODE_STRING String"], "addr": 659344}, "ZwEnableLastKnownGood": {"args": ["VOID"], "addr": 659408}, "ZwGetCachedSigningLevel": {"args": ["_In_ HANDLE File", "_Out_ PULONG Flags", "_Out_ PSE_SIGNING_LEVEL SigningLevel", "_Out_writes_bytes_to_opt_(*ThumbprintSize,*ThumbprintSize) PUCHAR Thumbprint", "_Inout_opt_ PULONG ThumbprintSize", "_Out_opt_ PULONG ThumbprintAlgorithm"], "addr": 660016}, "ZwGetCompleteWnfStateSubscription": {"args": ["_In_opt_ PWNF_STATE_NAME OldDescriptorStateName", "_In_opt_ ULONG64 *OldSubscriptionId", "_In_opt_ ULONG OldDescriptorEventMask", "_In_opt_ ULONG OldDescriptorStatus", "_Out_writes_bytes_(DescriptorSize) PWNF_DELIVERY_DESCRIPTOR NewDeliveryDescriptor", "_In_ ULONG DescriptorSize"], "addr": 660048}, "ZwGetCurrentProcessorNumber": {"args": ["_Out_ PPROCESSOR_NUMBER ProcNumber"], "addr": 660112}, "ZwLoadKey2": {"args": ["_In_ POBJECT_ATTRIBUTES  TargetKey", "_In_ POBJECT_ATTRIBUTES  SourceFile", "_In_ ULONG        Flags"], "addr": 660784}, "ZwLoadKeyEx": {"args": ["_In_ POBJECT_ATTRIBUTES   TargetKey", "_In_ POBJECT_ATTRIBUTES   SourceFile", "_In_ ULONG         Flags", "_In_opt_ HANDLE       TrustClassKey", "_In_opt_ HANDLE       Event", "_In_opt_ ACCESS_MASK    DesiredAccess", "_Out_opt_ PHANDLE      RootHandle", "_Out_opt_ PIO_STATUS_BLOCK IoStatus"], "addr": 660848}, "ZwLockProductActivationKeys": {"args": ["_Inout_opt_ ULONG  *pPrivateVer", "_Out_opt_ ULONG  *pSafeMode"], "addr": 660912}, "ZwNotifyChangeDirectoryFileEx": {"args": [], "addr": 661328}, "ZwOpenIoCompletion": {"args": ["_Out_ PHANDLE IoCompletionHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661552}, "ZwOpenMutant": {"args": ["_Out_ PHANDLE MutantHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 661744}, "ZwOpenTimer": {"args": ["_Out_ PHANDLE TimerHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_ POBJECT_ATTRIBUTES ObjectAttributes"], "addr": 662096}, "ZwOpenTransaction": {"args": ["_Out_ PHANDLE TmHandle", "_In_ ACCESS_MASK DesiredAccess", "_In_opt_ POBJECT_ATTRIBUTES ObjectAttributes", "_In_opt_ PUNICODE_STRING LogFileName", "_In_opt_ LPGUID TmIdentity", "_In_opt_ ULONG OpenOptions"], "addr": 662128}, "ZwQueryBootOptions": {"args": ["_Out_writes_bytes_opt_(*BootOptionsLength) PBOOT_OPTIONS BootOptions", "_Inout_ PULONG BootOptionsLength"], "addr": 662640}, "ZwQueryDebugFilterState": {"args": ["_In_ ULONG ComponentId", "_In_ ULONG Level"], "addr": 662672}, "ZwQueryEaFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_Out_writes_bytes_(Length) PVOID Buffer", "_In_ ULONG Length", "_In_ BOOLEAN ReturnSingleEntry", "_In_reads_bytes_opt_(EaListLength) PVOID EaList", "_In_ ULONG EaListLength", "_In_opt_ PULONG EaIndex", "_In_ BOOLEAN RestartScan"], "addr": 662800}, "ZwQueryInformationJobObject": {"args": ["_In_opt_ HANDLE JobHandle", "_In_ JOBOBJECTINFOCLASS JobObjectInformationClass", "_Out_writes_bytes_(JobObjectInformationLength) PVOID JobObjectInformation", "_In_ ULONG JobObjectInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 662992}, "ZwQueryInformationResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle", "_In_ RESOURCEMANAGER_INFORMATION_CLASS ResourceManagerInformationClass", "_Out_writes_bytes_(ResourceManagerInformationLength) PVOID ResourceManagerInformation", "_In_ ULONG ResourceManagerInformationLength", "_Out_opt_ PULONG ReturnLength"], "addr": 663056}, "ZwQueryTimerResolution": {"args": ["_Out_ PULONG MaximumTime", "_Out_ PULONG MinimumTime", "_Out_ PULONG CurrentTime"], "addr": 663792}, "ZwQueryWnfStateData": {"args": ["_In_ PCWNF_STATE_NAME StateName", "_In_opt_ PCWNF_TYPE_ID TypeId", "_In_opt_ const VOID* ExplicitScope", "_Out_ PWNF_CHANGE_STAMP ChangeStamp", "_Out_writes_bytes_to_opt_(*BufferSize,*BufferSize) PVOID Buffer", "_Inout_ PULONG BufferSize"], "addr": 663824}, "ZwRecoverResourceManager": {"args": ["_In_ HANDLE ResourceManagerHandle"], "addr": 664112}, "ZwRegisterProtocolAddressInformation": {"args": ["_In_ HANDLE ResourceManager", "_In_ PCRM_PROTOCOL_ID ProtocolId", "_In_ ULONG ProtocolInformationSize", "_In_ PVOID ProtocolInformation", "_In_opt_ ULONG CreateOptions"], "addr": 664176}, "ZwReleaseKeyedEvent": {"args": ["_In_ HANDLE KeyedEventHandle", "_In_ PVOID KeyValue", "_In_ BOOLEAN Alertable", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 664240}, "ZwReplacePartitionUnit": {"args": ["_In_ PUNICODE_STRING TargetInstancePath", "_In_ PUNICODE_STRING SpareInstancePath", "_In_ ULONG Flags"], "addr": 664464}, "ZwResetEvent": {"args": ["_In_ HANDLE EventHandle", "_Out_opt_ PLONG PreviousState"], "addr": 664560}, "ZwRollbackTransaction": {"args": ["_In_ HANDLE TransactionHandle", "_In_ BOOLEAN Wait"], "addr": 664816}, "ZwSetDefaultHardErrorPort": {"args": ["_In_ HANDLE DefaultHardErrorPort"], "addr": 665232}, "ZwSetDriverEntryOrder": {"args": ["_In_reads_(Count) PULONG Ids", "_In_ ULONG Count"], "addr": 665328}, "ZwSetInformationEnlistment": {"args": ["_In_opt_ HANDLE EnlistmentHandle", "_In_ ENLISTMENT_INFORMATION_CLASS EnlistmentInformationClass", "_In_reads_bytes_(EnlistmentInformationLength) PVOID EnlistmentInformation", "_In_ ULONG EnlistmentInformationLength"], "addr": 665552}, "ZwSetIoCompletionEx": {"args": ["_In_ HANDLE IoCompletionHandle", "_In_ HANDLE IoCompletionPacketHandle", "_In_opt_ PVOID KeyContext", "_In_opt_ PVOID ApcContext", "_In_ NTSTATUS IoStatus", "_In_ ULONG_PTR IoStatusInformation"], "addr": 665968}, "ZwSetQuotaInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_reads_bytes_(Length) PVOID Buffer", "_In_ ULONG Length"], "addr": 666096}, "ZwSetSecurityObject": {"args": ["_In_ HANDLE Handle", "_In_ SECURITY_INFORMATION SecurityInformation", "_In_ PSECURITY_DESCRIPTOR SecurityDescriptor"], "addr": 666128}, "ZwSetSystemTime": {"args": ["_In_opt_ PLARGE_INTEGER SystemTime", "_Out_opt_ PLARGE_INTEGER PreviousTime"], "addr": 666288}, "ZwSetTimerEx": {"args": ["_In_ HANDLE TimerHandle", "_In_ TIMER_SET_INFORMATION_CLASS TimerSetInformationClass", "_Inout_updates_bytes_opt_(TimerSetInformationLength) PVOID TimerSetInformation", "_In_ ULONG TimerSetInformationLength"], "addr": 666384}, "ZwSetTimerResolution": {"args": ["_In_ ULONG DesiredTime", "_In_ BOOLEAN SetResolution", "_Out_ PULONG ActualTime"], "addr": 666416}, "ZwSetUuidSeed": {"args": ["_In_reads_bytes_(6) PCHAR Seed"], "addr": 666448}, "ZwSetVolumeInformationFile": {"args": ["_In_ HANDLE FileHandle", "_Out_ PIO_STATUS_BLOCK IoStatusBlock", "_In_reads_bytes_(Length) PVOID FsInformation", "_In_ ULONG Length", "_In_ FS_INFORMATION_CLASS FsInformationClass"], "addr": 666480}, "ZwSignalAndWaitForSingleObject": {"args": ["_In_ HANDLE SignalHandle", "_In_ HANDLE WaitHandle", "_In_ BOOLEAN Alertable", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 666608}, "ZwSinglePhaseReject": {"args": ["_In_ HANDLE EnlistmentHandle", "_In_opt_ PLARGE_INTEGER TmVirtualClock"], "addr": 666640}, "ZwTerminateJobObject": {"args": ["_In_ HANDLE JobHandle", "_In_ NTSTATUS ExitStatus"], "addr": 666928}, "ZwTestAlert": {"args": ["VOID"], "addr": 666960}, "ZwTraceControl": {"args": ["_In_ ULONG FunctionCode", "_In_reads_bytes_opt_(InBufferLen) PVOID InBuffer", "_In_ ULONG InBufferLen", "_Out_writes_bytes_opt_(OutBufferLen) PVOID OutBuffer", "_In_ ULONG OutBufferLen", "_Out_ PULONG ReturnSize"], "addr": 667056}, "ZwUmsThreadYield": {"args": ["_In_ PVOID SchedulerParam"], "addr": 667120}, "ZwUnloadKey": {"args": ["_In_ POBJECT_ATTRIBUTES TargetKey"], "addr": 667184}, "ZwWaitForKeyedEvent": {"args": ["_In_ HANDLE KeyedEventHandle", "_In_ PVOID KeyValue", "_In_ BOOLEAN Alertable", "_In_opt_ PLARGE_INTEGER Timeout"], "addr": 667536}, "ZwWaitHighEventPair": {"args": ["_In_ HANDLE EventPairHandle"], "addr": 667600}, "ZwWaitLowEventPair": {"args": ["_In_ HANDLE EventPairHandle"], "addr": 667632}}, "win32u.dll": {"NtUserGetProp": {"args": [], "addr": 5664}, "NtUserPostMessage": {"args": [], "addr": 5696}, "NtUserTranslateAccelerator": {"args": [], "addr": 5760}, "NtUserGetKeyboardLayoutList": {"args": [], "addr": 7936}, "NtGdiGetWidthTable": {"args": ["_In_ HDC hdc", "_In_ ULONG cSpecial", "_In_reads_(cwc) const WCHAR *pwc", "_In_ ULONG cwc", "_Out_writes_(cwc) USHORT *psWidth", "_Out_opt_ WIDTHDATA *pwd", "_Out_ FLONG *pflInfo"], "addr": 8448}, "NtUserGetObjectInformation": {"args": [], "addr": 8512}, "NtUserToUnicodeEx": {"args": [], "addr": 8928}, "NtGdiOffsetRgn": {"args": ["_In_ HRGN hrgn", "_In_ int cx", "_In_ int cy"], "addr": 9056}, "NtUserGetScrollBarInfo": {"args": [], "addr": 9728}, "NtGdiGetDCforBitmap": {"args": ["_In_ HBITMAP hsurf"], "addr": 9984}, "NtUserOpenWindowStation": {"args": [], "addr": 10112}, "NtUserSetCursorIconData": {"args": [], "addr": 10144}, "NtUserGetClipboardOwner": {"args": [], "addr": 11136}, "NtUserValidateRect": {"args": [], "addr": 11264}, "NtUserGetAltTabInfo": {"args": [], "addr": 12448}, "NtUserConvertMemHandle": {"args": [], "addr": 12768}, "NtUserChangeClipboardChain": {"args": [], "addr": 13632}, "NtUserShowWindowAsync": {"args": [], "addr": 13696}, "NtGdiCreateColorSpace": {"args": ["_In_ PLOGCOLORSPACEEXW pLogColorSpace"], "addr": 13728}, "NtDCompositionGetFrameId": {"args": [], "addr": 14816}, "NtDCompositionGetStatistics": {"args": [], "addr": 15008}, "NtDCompositionReferenceSharedResourceOnDwmChannel": {"args": [], "addr": 15136}, "NtDCompositionWaitForCompositorClock": {"args": [], "addr": 15680}, "NtDxgkCreateDoorbell": {"args": [], "addr": 15872}, "NtDxgkDisplayPortOperation": {"args": [], "addr": 16064}, "NtFlipObjectConsumerAdjustUsageReference": {"args": [], "addr": 16896}, "NtGdiCLIPOBJ_ppoGetPath": {"args": ["_In_ CLIPOBJ *pco"], "addr": 18048}, "NtGdiConvertMetafileRect": {"args": ["_In_ HDC hdc", "_Inout_ PRECTL prect"], "addr": 18304}, "NtGdiCreateSessionMappedDIBSection": {"args": ["_In_opt_ HDC hdc", "_In_opt_ HANDLE hSectionApp", "_In_ DWORD dwOffset", "_In_reads_bytes_opt_(cjHeader) LPBITMAPINFO pbmi", "_In_ DWORD iUsage", "_In_ UINT cjHeader", "_In_ FLONG fl", "_In_ ULONG_PTR dwColorSpace"], "addr": 18656}, "NtGdiDdDDIDestroyDevice": {"args": [], "addr": 20160}, "NtGdiDdDDIDispMgrCreate": {"args": [], "addr": 20448}, "NtGdiDdDDIGetContextInProcessSchedulingPriority": {"args": [], "addr": 20864}, "NtGdiDdDDIInvalidateActiveVidPn": {"args": [], "addr": 21632}, "NtGdiDdDDINetDispQueryMiracastDisplayDeviceSupport": {"args": [], "addr": 21920}, "NtGdiDdDDIOpenKeyedMutex2": {"args": [], "addr": 22208}, "NtGdiDdDDIOpenNtHandleFromName": {"args": [], "addr": 22272}, "NtGdiDdDDIOpenSyncObjectFromNtHandle2": {"args": [], "addr": 22464}, "NtGdiDdDDIOpenSyncObjectNtHandleFromName": {"args": [], "addr": 22496}, "NtGdiDdDDIPollDisplayChildren": {"args": [], "addr": 22720}, "NtGdiDdDDIPresent": {"args": [], "addr": 22752}, "NtGdiDdDDIQueryAdapterInfo": {"args": [], "addr": 22912}, "NtGdiDdDDISetYieldPercentage": {"args": [], "addr": 24224}, "NtGdiDdDDISharedPrimaryLockNotification": {"args": [], "addr": 24288}, "NtGdiDdDDIWaitForSynchronizationObjectFromCpu": {"args": [], "addr": 24896}, "NtGdiDeleteColorTransform": {"args": ["_In_ HDC hdc", "_In_ HANDLE hColorTransform"], "addr": 25120}, "NtGdiEllipse": {"args": ["_In_ HDC hdc", "_In_ int xLeft", "_In_ int yTop", "_In_ int xRight", "_In_ int yBottom"], "addr": 25344}, "NtGdiEngEraseSurface": {"args": ["_In_ SURFOBJ *pso", "_In_ RECTL *prcl", "_In_ ULONG iColor"], "addr": 25984}, "NtGdiEngStrokePath": {"args": ["_In_ SURFOBJ *pso", "_In_ PATHOBJ *ppo", "_In_ CLIPOBJ *pco", "_In_ XFORMOBJ *pxo", "_In_ BRUSHOBJ *pbo", "_In_ POINTL *pptlBrushOrg", "_In_ LINEATTRS *plineattrs", "_In_ MIX mix"], "addr": 26336}, "NtGdiFONTOBJ_cGetAllGlyphHandles": {"args": ["_In_ FONTOBJ *pfo", "__out_post_ecount_opt(return) HGLYPH *phg"], "addr": 26624}, "NtGdiFONTOBJ_vGetInfo": {"args": ["_In_ FONTOBJ *pfo", "_In_ ULONG cjSize", "_Out_writes_bytes_(cjSize) FONTINFO *pfi"], "addr": 26848}, "NtGdiGetColorAdjustment": {"args": ["_In_ HDC hdc", "_Out_ PCOLORADJUSTMENT pcaOut"], "addr": 27328}, "NtGdiGetDhpdev": {"args": ["_In_ HDEV hdev"], "addr": 27552}, "NtGdiGetSuggestedOPMProtectedOutputArraySize": {"args": [], "addr": 28576}, "NtGdiGetUFI": {"args": ["_In_ HDC hdc", "_Out_ PUNIVERSAL_FONT_ID pufi", "_Out_opt_ DESIGNVECTOR *pdv", "_Out_ ULONG *pcjDV", "_Out_ ULONG *pulBaseCheckSum", "_Out_ FLONG *pfl"], "addr": 28640}, "NtGdiIcmBrushInfo": {"args": ["_In_ HDC hdc", "_In_ HBRUSH hbrush", "_Inout_updates_bytes_(sizeof(BITMAPINFO) + ((/*MAX_COLORTABLE*/256 - 1) * sizeof(RGBQUAD))) PBITMAPINFO pbmiDIB", "_Inout_updates_bytes_(*pulBits) PVOID pvBits", "_Inout_ ULONG *pulBits", "_Out_opt_ DWORD *piUsage", "_Out_opt_ BOOL *pbAlreadyTran", "_In_ ULONG Command"], "addr": 28864}, "NtGdiPtInRegion": {"args": ["_In_ HRGN hrgn", "_In_ int x", "_In_ int y"], "addr": 29504}, "NtGdiSTROBJ_bGetAdvanceWidths": {"args": ["_In_ STROBJ*pstro", "_In_ ULONG iFirst", "_In_ ULONG c", "_Out_writes_(c) POINTQF*pptqD"], "addr": 29824}, "NtGdiSelectPen": {"args": ["_In_ HDC hdc", "_In_ HPEN hpen"], "addr": 30112}, "NtGdiSetFontXform": {"args": ["_In_ HDC hdc", "_In_ DWORD dwxScale", "_In_ DWORD dwyScale"], "addr": 30272}, "NtGdiSetSystemPaletteUse": {"args": ["_In_ HDC hdc", "_In_ UINT ui"], "addr": 30560}, "NtGdiStrokeAndFillPath": {"args": ["_In_ HDC hdc"], "addr": 30720}, "NtGdiUpdateColors": {"args": ["_In_ HDC hdc"], "addr": 30944}, "NtGdiXLATEOBJ_hGetColorTransform": {"args": ["_In_ XLATEOBJ *pxlo"], "addr": 31168}, "NtMITSetKeyboardOverriderState": {"args": [], "addr": 32128}, "NtModerncoreGetWindowContentVisual": {"args": [], "addr": 32800}, "NtQueryCompositionInputSinkLuid": {"args": [], "addr": 33280}, "NtRIMOnAsyncPnpWorkNotification": {"args": [], "addr": 33888}, "NtRIMOnPnpNotification": {"args": [], "addr": 33920}, "NtSetCompositionSurfaceBufferUsage": {"args": [], "addr": 34304}, "NtUserBeginDeferWindowPos": {"args": [], "addr": 35136}, "NtUserChangeWindowMessageFilter": {"args": [], "addr": 35488}, "NtUserCreateDesktopEx": {"args": [], "addr": 36160}, "NtUserCreateEmptyCursorObject": {"args": [], "addr": 36192}, "NtUserDelegateInput": {"args": [], "addr": 36640}, "NtUserDisplayConfigGetDeviceInfo": {"args": [], "addr": 37024}, "NtUserEnableMouseInPointer": {"args": [], "addr": 37792}, "NtUserEnableWindowResizeOptimization": {"args": [], "addr": 38176}, "NtUserEndMenu": {"args": [], "addr": 38208}, "NtUserGetDesktopVisualTransform": {"args": [], "addr": 39136}, "NtUserGetDeviceChangeInfo": {"args": [], "addr": 39168}, "NtUserGetGestureExtArgs": {"args": [], "addr": 39424}, "NtUserGetInputEvent": {"args": [], "addr": 39744}, "NtUserGetMenuIndex": {"args": [], "addr": 40128}, "NtUserGetRawInputBuffer": {"args": [], "addr": 41056}, "NtUserGetRawInputDeviceInfo": {"args": [], "addr": 41120}, "NtUserGetRequiredCursorSizes": {"args": [], "addr": 41248}, "NtUserGetWindowDisplayAffinity": {"args": [], "addr": 41856}, "NtUserInitAnsiOem": {"args": [], "addr": 42464}, "NtUserInjectMouseInput": {"args": [], "addr": 42912}, "NtUserLoadCursorsAndIcons": {"args": [], "addr": 43520}, "NtUserLockWindowStation": {"args": [], "addr": 43680}, "NtUserMagControl": {"args": [], "addr": 43904}, "NtUserPromotePointer": {"args": [], "addr": 44832}, "NtUserRegisterForTooltipDismissNotification": {"args": [], "addr": 45408}, "NtUserRegisterSessionPort": {"args": [], "addr": 45728}, "NtUserRemoteRedrawScreen": {"args": [], "addr": 46432}, "NtUserRemoteShadowCleanup": {"args": [], "addr": 46464}, "NtUserResolveDesktopForWOW": {"args": [], "addr": 46880}, "NtUserSetCancelRotationDelayHintWindow": {"args": [], "addr": 47328}, "NtUserSetCaretPos": {"args": [], "addr": 47392}, "NtUserSetCursorIconDataEx": {"args": [], "addr": 47552}, "NtUserSetCursorPos": {"args": [], "addr": 47584}, "NtUserSetDialogControlDpiChangeBehavior": {"args": [], "addr": 47680}, "NtUserSetImeOwnerWindow": {"args": [], "addr": 48224}, "NtUserSetMsgBox": {"args": [], "addr": 48736}, "NtUserSetProcessDefaultLayout": {"args": [], "addr": 48832}, "NtUserSetTaskmanWindow": {"args": [], "addr": 49408}, "NtUserSetVisible": {"args": [], "addr": 49536}, "NtUserSetWindowCompositionAttribute": {"args": [], "addr": 49664}, "NtUserSetWindowContextHelpId": {"args": [], "addr": 49728}, "NtUserSetWindowRgnEx": {"args": [], "addr": 49824}, "NtUserSetWindowShowState": {"args": [], "addr": 49856}, "NtUserShellHandwritingUndelegateInput": {"args": [], "addr": 50016}, "NtUserSwapMouseButton": {"args": [], "addr": 50496}, "NtUserSwitchDesktop": {"args": [], "addr": 50528}, "NtUserUpdateInstance": {"args": [], "addr": 51136}}};
var funcs_map = {};
var register_args = ["rcx", "rdx", "r8", "r9"];

function lib_includes(libname, liblist) {
  for (var i = 0; i < liblist.length; i++) {
    if (libname.toLowerCase() == liblist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function func_includes(funcname, funclist) {
  for (var i = 0; i < funclist.length; i++) {
    if (funcname.toLowerCase() == funclist[i].toLowerCase()) {
      return true
    }
  }
  return false
}

function mutate_n(n, ratio){
  return n + Math.floor(Math.random() * ratio) - ratio/2;
}

function mutate_buf(ptr, size, arg_i) {
  let buf = Memory.readByteArray(ptr, size);
  let buf_view = new Uint8Array(buf);
  // deep copy buf
  let new_buf = new ArrayBuffer(size);
  let new_buf_view = new Uint8Array(new_buf);
  for (let i = 0; i < size; i++) {
      if (Math.random() < 0.9) {
        new_buf_view[i] = buf_view[i];
      }else{
        new_buf_view[i] = mutate_n(buf_view[i], 10)
        }
    }
  Memory.writeByteArray(ptr, new_buf_view);
  console.log("Mutating buffer arg " + arg_i);
  console.log("From:");
  console.log(buf);
  console.log("To:");
  console.log(new_buf);
}

function mutate_args(context, args, f_args_infos) {
  let syscall_args = ["rcx", "rdx", "r8", "r9"];
  for (let i = 0; i < args.length; i++) {
    if(Math.random() > 0.05){
        continue;
    }
    if (Memory.readPointer(args[i]) != 0) {
       mutate_buf(Memory.readPointer(args[i]), 0x100, i);
    }
    else if (i < syscall_args.length) {
        let reg_name = syscall_args[i];
        // convert to int
        let reg_val = parseInt(args[i]);
        let new_val = mutate_n(reg_val, 10000);
        context[reg_name] = new_val;
        let hex_val = "0x" + new_val.toString(16);
        console.log("Mutating " + reg_name + " from " + args[i] + " to " + hex_val);
    }
  }
}


setTimeout(function() {
  Process.enumerateModules({
    onMatch: function(module) {
      //console.log("Found " + module.name + " at " + module.base);
      if (lib_includes(module.name, Object.keys(sys_data))) {
        let exports = module.enumerateExports();
        let module_name = module.name.toLowerCase();
        for (let f_name in sys_data[module_name]) {
          // call random function
          
          let infos = sys_data[module_name][f_name];
          let ea = infos["addr"]
          ea = module.base.add(ptr(ea));
          funcs_map[ea] = [f_name, module.name]
          try {
            //console.log("Hooking " + f_name + " at " + ea);
            Interceptor.attach(ea, {
              onEnter: function(args) {
                let f_name = funcs_map[this.context.pc][0];
                let module_name = funcs_map[this.context.pc][1];
                console.log(f_name); 
                let rcx = this.context.rcx;
                let rdx = this.context.rdx;
                let r8 = this.context.r8;
                let r9 = this.context.r9;
                let syscall_args = [rcx, rdx, r8, r9];
                let arg_index = 0;
                let stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                while (stack_arg != 0 && arg_index < 4) {
                  stack_arg = Memory.readPointer(this.context.rsp.add(arg_index * Process.pointerSize));
                  syscall_args.push(stack_arg);
                  arg_index++;
                }
                let f_args_infos = sys_data[module_name][f_name]["args"];
                for (let i = 0; i < syscall_args.length; i++) {
                  let arg_info = "";
                  if (i < f_args_infos.length) {
                    arg_info = f_args_infos[i];
                  }
                  console.log("Arg " + i + ": " + " " + arg_info + " " + syscall_args[i]);
                }
                mutate_args(this.context, syscall_args, f_args_infos);
                
              }
            });
          } catch (e) {
            console.log("Error: " + e);
          }
        }
      }
    },
    onComplete: function() {
    }
  });
}, 500);
